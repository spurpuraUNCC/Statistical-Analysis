import numpy as np
import pandas as pd
import seaborn as sns
from scipy.stats import t
from scipy import stats
from scipy.stats import skew
import math
import matplotlib.pyplot as plt

def compare(df1,df2,df3,outfile):
    
#Create arrays for each of the variables from dataframes    
    ##Top of dataframes: 
    #upstream
    top_up_sfc_p=(((np.array(df1[1:2])).flatten())[1:].astype('float64'))
    top_up_lcl=(((np.array(df1[3:4])).flatten())[1:].astype('float64'))
    top_up_lfc=(((np.array(df1[4:5])).flatten())[1:].astype('float64'))
    top_up_el=(((np.array(df1[5:6])).flatten())[1:].astype('float64'))
    top_up_h0=(((np.array(df1[6:7])).flatten())[1:].astype('float64'))
    top_up_h_neg20=(((np.array(df1[8:9])).flatten())[1:].astype('float64'))
    top_up_wbzh=(((np.array(df1[9:10])).flatten())[1:].astype('float64'))
    top_up_1km_srh=(((np.array(df1[10:11])).flatten())[1:].astype('float64'))
    top_up_1km_shear=(((np.array(df1[11:12])).flatten())[1:].astype('float64'))
    top_up_3km_srh=(((np.array(df1[12:13])).flatten())[1:].astype('float64'))
    top_up_3km_shear=(((np.array(df1[13:14])).flatten())[1:].astype('float64'))
    top_up_6km_shear=(((np.array(df1[14:15])).flatten())[1:].astype('float64'))
    top_up_sbcape=(((np.array(df1[15:16])).flatten())[1:].astype('float64'))
    top_up_sbcin=(((np.array(df1[16:17])).flatten())[1:].astype('float64'))
    top_up_mlcape=(((np.array(df1[17:18])).flatten())[1:].astype('float64'))
    top_up_mlcin=(((np.array(df1[18:19])).flatten())[1:].astype('float64'))
    top_up_mucape=(((np.array(df1[19:20])).flatten())[1:].astype('float64'))
    top_up_mucin=(((np.array(df1[20:21])).flatten())[1:].astype('float64'))
    top_up_stp=(((np.array(df1[21:22])).flatten())[1:].astype('float64'))
    top_up_scp=(((np.array(df1[22:23])).flatten())[1:].astype('float64'))
    top_up_1km_lapse=(((np.array(df1[24:25])).flatten())[1:].astype('float64'))
    top_up_2km_lapse=(((np.array(df1[25:26])).flatten())[1:].astype('float64'))
    top_up_3km_lapse=(((np.array(df1[26:27])).flatten())[1:].astype('float64'))
    top_up_6km_lapse=(((np.array(df1[27:28])).flatten())[1:].astype('float64'))
    top_up_mid_lapse=(((np.array(df1[28:29])).flatten())[1:].astype('float64'))
    top_up_mid_rh=(((np.array(df1[29:30])).flatten())[1:].astype('float64'))
    top_up_sherb=(((np.array(df1[30:31])).flatten())[1:].astype('float64'))
    top_up_sfc_theta=(((np.array(df1[31:32])).flatten())[1:].astype('float64'))
    top_up_ml_theta=(((np.array(df1[32:33])).flatten())[1:].astype('float64'))
    top_up_dcape=(((np.array(df1[33:34])).flatten())[1:].astype('float64'))
    
    #Peak
    top_peak_sfc_p=(((np.array(df2[1:2])).flatten())[1:].astype('float64'))
    top_peak_lcl=(((np.array(df2[3:4])).flatten())[1:].astype('float64'))
    top_peak_lfc=(((np.array(df2[4:5])).flatten())[1:].astype('float64'))
    top_peak_el=(((np.array(df2[5:6])).flatten())[1:].astype('float64'))
    top_peak_h0=(((np.array(df2[6:7])).flatten())[1:].astype('float64'))
    top_peak_h_neg20=(((np.array(df2[8:9])).flatten())[1:].astype('float64'))
    top_peak_wbzh=(((np.array(df2[9:10])).flatten())[1:].astype('float64'))
    top_peak_1km_srh=(((np.array(df2[10:11])).flatten())[1:].astype('float64'))
    top_peak_1km_shear=(((np.array(df2[11:12])).flatten())[1:].astype('float64'))
    top_peak_3km_srh=(((np.array(df2[12:13])).flatten())[1:].astype('float64'))
    top_peak_3km_shear=(((np.array(df2[13:14])).flatten())[1:].astype('float64'))
    top_peak_6km_shear=(((np.array(df2[14:15])).flatten())[1:].astype('float64'))
    top_peak_sbcape=(((np.array(df2[15:16])).flatten())[1:].astype('float64'))
    top_peak_sbcin=(((np.array(df2[16:17])).flatten())[1:].astype('float64'))
    top_peak_mlcape=(((np.array(df2[17:18])).flatten())[1:].astype('float64'))
    top_peak_mlcin=(((np.array(df2[18:19])).flatten())[1:].astype('float64'))
    top_peak_mucape=(((np.array(df2[19:20])).flatten())[1:].astype('float64'))
    top_peak_mucin=(((np.array(df2[20:21])).flatten())[1:].astype('float64'))
    top_peak_stp=(((np.array(df2[21:22])).flatten())[1:].astype('float64'))
    top_peak_scp=(((np.array(df2[22:23])).flatten())[1:].astype('float64'))
    top_peak_1km_lapse=(((np.array(df2[24:25])).flatten())[1:].astype('float64'))
    top_peak_2km_lapse=(((np.array(df2[25:26])).flatten())[1:].astype('float64'))
    top_peak_3km_lapse=(((np.array(df2[26:27])).flatten())[1:].astype('float64'))
    top_peak_6km_lapse=(((np.array(df2[27:28])).flatten())[1:].astype('float64'))
    top_peak_mid_lapse=(((np.array(df2[28:29])).flatten())[1:].astype('float64'))
    top_peak_mid_rh=(((np.array(df2[29:30])).flatten())[1:].astype('float64'))
    top_peak_sherb=(((np.array(df2[30:31])).flatten())[1:].astype('float64'))
    top_peak_sfc_theta=(((np.array(df2[31:32])).flatten())[1:].astype('float64'))
    top_peak_ml_theta=(((np.array(df2[32:33])).flatten())[1:].astype('float64'))
    top_peak_dcape=(((np.array(df2[33:34])).flatten())[1:].astype('float64'))


    #Down
    top_down_sfc_p=(((np.array(df3[1:2])).flatten())[1:].astype('float64'))
    top_down_lcl=(((np.array(df3[3:4])).flatten())[1:].astype('float64'))
    top_down_lfc=(((np.array(df3[4:5])).flatten())[1:].astype('float64'))
    top_down_el=(((np.array(df3[5:6])).flatten())[1:].astype('float64'))
    top_down_h0=(((np.array(df3[6:7])).flatten())[1:].astype('float64'))
    top_down_h_neg20=(((np.array(df3[8:9])).flatten())[1:].astype('float64'))
    top_down_wbzh=(((np.array(df3[9:10])).flatten())[1:].astype('float64'))
    top_down_1km_srh=(((np.array(df3[10:11])).flatten())[1:].astype('float64'))
    top_down_1km_shear=(((np.array(df3[11:12])).flatten())[1:].astype('float64'))
    top_down_3km_srh=(((np.array(df3[12:13])).flatten())[1:].astype('float64'))
    top_down_3km_shear=(((np.array(df3[13:14])).flatten())[1:].astype('float64'))
    top_down_6km_shear=(((np.array(df3[14:15])).flatten())[1:].astype('float64'))
    top_down_sbcape=(((np.array(df3[15:16])).flatten())[1:].astype('float64'))
    top_down_sbcin=(((np.array(df3[16:17])).flatten())[1:].astype('float64'))
    top_down_mlcape=(((np.array(df3[17:18])).flatten())[1:].astype('float64'))
    top_down_mlcin=(((np.array(df3[18:19])).flatten())[1:].astype('float64'))
    top_down_mucape=(((np.array(df3[19:20])).flatten())[1:].astype('float64'))
    top_down_mucin=(((np.array(df3[20:21])).flatten())[1:].astype('float64'))
    top_down_stp=(((np.array(df3[21:22])).flatten())[1:].astype('float64'))
    top_down_scp=(((np.array(df3[22:23])).flatten())[1:].astype('float64'))
    top_down_1km_lapse=(((np.array(df3[24:25])).flatten())[1:].astype('float64'))
    top_down_2km_lapse=(((np.array(df3[25:26])).flatten())[1:].astype('float64'))
    top_down_3km_lapse=(((np.array(df3[26:27])).flatten())[1:].astype('float64'))
    top_down_6km_lapse=(((np.array(df3[27:28])).flatten())[1:].astype('float64'))
    top_down_mid_lapse=(((np.array(df3[28:29])).flatten())[1:].astype('float64'))
    top_down_mid_rh=(((np.array(df3[29:30])).flatten())[1:].astype('float64'))
    top_down_sherb=(((np.array(df3[30:31])).flatten())[1:].astype('float64'))
    top_down_sfc_theta=(((np.array(df3[31:32])).flatten())[1:].astype('float64'))
    top_down_ml_theta=(((np.array(df3[32:33])).flatten())[1:].astype('float64'))
    top_down_dcape=(((np.array(df3[33:34])).flatten())[1:].astype('float64'))
    
    #bottom of dataframe:
    #upstream
    bottom_up_sfc_p=(((np.array(df1[37:38])).flatten())[1:].astype('float64'))
    bottom_up_lcl=(((np.array(df1[39:40])).flatten())[1:].astype('float64'))
    bottom_up_lfc=(((np.array(df1[40:41])).flatten())[1:].astype('float64'))
    bottom_up_el=(((np.array(df1[41:42])).flatten())[1:].astype('float64'))
    bottom_up_h0=(((np.array(df1[42:43])).flatten())[1:].astype('float64'))
    bottom_up_h_neg20=(((np.array(df1[43:44])).flatten())[1:].astype('float64'))
    bottom_up_wbzh=(((np.array(df1[45:46])).flatten())[1:].astype('float64'))
    bottom_up_1km_srh=(((np.array(df1[46:47])).flatten())[1:].astype('float64'))
    bottom_up_1km_shear=(((np.array(df1[47:48])).flatten())[1:].astype('float64'))
    bottom_up_3km_srh=(((np.array(df1[48:49])).flatten())[1:].astype('float64'))
    bottom_up_3km_shear=(((np.array(df1[49:50])).flatten())[1:].astype('float64'))
    bottom_up_6km_shear=(((np.array(df1[50:51])).flatten())[1:].astype('float64'))
    bottom_up_sbcape=(((np.array(df1[51:52])).flatten())[1:].astype('float64'))
    bottom_up_sbcin=(((np.array(df1[52:53])).flatten())[1:].astype('float64'))
    bottom_up_mlcape=(((np.array(df1[53:54])).flatten())[1:].astype('float64'))
    bottom_up_mlcin=(((np.array(df1[54:55])).flatten())[1:].astype('float64'))
    bottom_up_mucape=(((np.array(df1[55:56])).flatten())[1:].astype('float64'))
    bottom_up_mucin=(((np.array(df1[56:57])).flatten())[1:].astype('float64'))
    bottom_up_stp=(((np.array(df1[57:58])).flatten())[1:].astype('float64'))
    bottom_up_scp=(((np.array(df1[58:59])).flatten())[1:].astype('float64'))
    bottom_up_1km_lapse=(((np.array(df1[60:61])).flatten())[1:].astype('float64'))
    bottom_up_2km_lapse=(((np.array(df1[61:62])).flatten())[1:].astype('float64'))
    bottom_up_3km_lapse=(((np.array(df1[62:63])).flatten())[1:].astype('float64'))
    bottom_up_6km_lapse=(((np.array(df1[63:64])).flatten())[1:].astype('float64'))
    bottom_up_mid_lapse=(((np.array(df1[64:65])).flatten())[1:].astype('float64'))
    bottom_up_mid_rh=(((np.array(df1[65:66])).flatten())[1:].astype('float64'))
    bottom_up_sherb=(((np.array(df1[66:67])).flatten())[1:].astype('float64'))
    bottom_up_sfc_theta=(((np.array(df1[67:68])).flatten())[1:].astype('float64'))
    bottom_up_ml_theta=(((np.array(df1[68:69])).flatten())[1:].astype('float64'))
    bottom_up_dcape=(((np.array(df1[69:70])).flatten())[1:].astype('float64'))



    #Peak
    bottom_peak_sfc_p=(((np.array(df2[37:38])).flatten())[1:].astype('float64'))
    bottom_peak_lcl=(((np.array(df2[39:40])).flatten())[1:].astype('float64'))
    bottom_peak_lfc=(((np.array(df2[40:41])).flatten())[1:].astype('float64'))
    bottom_peak_el=(((np.array(df2[41:42])).flatten())[1:].astype('float64'))
    bottom_peak_h0=(((np.array(df2[42:43])).flatten())[1:].astype('float64'))
    bottom_peak_h_neg20=(((np.array(df2[43:44])).flatten())[1:].astype('float64'))
    bottom_peak_wbzh=(((np.array(df2[45:46])).flatten())[1:].astype('float64'))
    bottom_peak_1km_srh=(((np.array(df2[46:47])).flatten())[1:].astype('float64'))
    bottom_peak_1km_shear=(((np.array(df2[47:48])).flatten())[1:].astype('float64'))
    bottom_peak_3km_srh=(((np.array(df2[48:49])).flatten())[1:].astype('float64'))
    bottom_peak_3km_shear=(((np.array(df2[49:50])).flatten())[1:].astype('float64'))
    bottom_peak_6km_shear=(((np.array(df2[50:51])).flatten())[1:].astype('float64'))
    bottom_peak_sbcape=(((np.array(df2[51:52])).flatten())[1:].astype('float64'))
    bottom_peak_sbcin=(((np.array(df2[52:53])).flatten())[1:].astype('float64'))
    bottom_peak_mlcape=(((np.array(df2[53:54])).flatten())[1:].astype('float64'))
    bottom_peak_mlcin=(((np.array(df2[54:55])).flatten())[1:].astype('float64'))
    bottom_peak_mucape=(((np.array(df2[55:56])).flatten())[1:].astype('float64'))
    bottom_peak_mucin=(((np.array(df2[56:57])).flatten())[1:].astype('float64'))
    bottom_peak_stp=(((np.array(df2[57:58])).flatten())[1:].astype('float64'))
    bottom_peak_scp=(((np.array(df2[58:59])).flatten())[1:].astype('float64'))
    bottom_peak_1km_lapse=(((np.array(df2[60:61])).flatten())[1:].astype('float64'))
    bottom_peak_2km_lapse=(((np.array(df2[61:62])).flatten())[1:].astype('float64'))
    bottom_peak_3km_lapse=(((np.array(df2[62:63])).flatten())[1:].astype('float64'))
    bottom_peak_6km_lapse=(((np.array(df2[63:64])).flatten())[1:].astype('float64'))
    bottom_peak_mid_lapse=(((np.array(df2[64:65])).flatten())[1:].astype('float64'))
    bottom_peak_mid_rh=(((np.array(df2[65:66])).flatten())[1:].astype('float64'))
    bottom_peak_sherb=(((np.array(df2[66:67])).flatten())[1:].astype('float64'))
    bottom_peak_sfc_theta=(((np.array(df2[67:68])).flatten())[1:].astype('float64'))
    bottom_peak_ml_theta=(((np.array(df2[68:69])).flatten())[1:].astype('float64'))
    bottom_peak_dcape=(((np.array(df2[69:70])).flatten())[1:].astype('float64'))




    #Down
    bottom_down_sfc_p=(((np.array(df3[37:38])).flatten())[1:].astype('float64'))
    bottom_down_lcl=(((np.array(df3[39:40])).flatten())[1:].astype('float64'))
    bottom_down_lfc=(((np.array(df3[40:41])).flatten())[1:].astype('float64'))
    bottom_down_el=(((np.array(df3[41:42])).flatten())[1:].astype('float64'))
    bottom_down_h0=(((np.array(df3[42:43])).flatten())[1:].astype('float64'))
    bottom_down_h_neg20=(((np.array(df3[43:44])).flatten())[1:].astype('float64'))
    bottom_down_wbzh=(((np.array(df3[45:46])).flatten())[1:].astype('float64'))
    bottom_down_1km_srh=(((np.array(df3[46:47])).flatten())[1:].astype('float64'))
    bottom_down_1km_shear=(((np.array(df3[47:48])).flatten())[1:].astype('float64'))
    bottom_down_3km_srh=(((np.array(df3[48:49])).flatten())[1:].astype('float64'))
    bottom_down_3km_shear=(((np.array(df3[49:50])).flatten())[1:].astype('float64'))
    bottom_down_6km_shear=(((np.array(df3[50:51])).flatten())[1:].astype('float64'))
    bottom_down_sbcape=(((np.array(df3[51:52])).flatten())[1:].astype('float64'))
    bottom_down_sbcin=(((np.array(df3[52:53])).flatten())[1:].astype('float64'))
    bottom_down_mlcape=(((np.array(df3[53:54])).flatten())[1:].astype('float64'))
    bottom_down_mlcin=(((np.array(df3[54:55])).flatten())[1:].astype('float64'))
    bottom_down_mucape=(((np.array(df3[55:56])).flatten())[1:].astype('float64'))
    bottom_down_mucin=(((np.array(df3[56:57])).flatten())[1:].astype('float64'))
    bottom_down_stp=(((np.array(df3[57:58])).flatten())[1:].astype('float64'))
    bottom_down_scp=(((np.array(df3[58:59])).flatten())[1:].astype('float64'))
    bottom_down_1km_lapse=(((np.array(df3[60:61])).flatten())[1:].astype('float64'))
    bottom_down_2km_lapse=(((np.array(df3[61:62])).flatten())[1:].astype('float64'))
    bottom_down_3km_lapse=(((np.array(df3[62:63])).flatten())[1:].astype('float64'))
    bottom_down_6km_lapse=(((np.array(df3[63:64])).flatten())[1:].astype('float64'))
    bottom_down_mid_lapse=(((np.array(df3[64:65])).flatten())[1:].astype('float64'))
    bottom_down_mid_rh=(((np.array(df3[65:66])).flatten())[1:].astype('float64'))
    bottom_down_sherb=(((np.array(df3[66:67])).flatten())[1:].astype('float64'))
    bottom_down_sfc_theta=(((np.array(df3[67:68])).flatten())[1:].astype('float64'))
    bottom_down_ml_theta=(((np.array(df3[68:69])).flatten())[1:].astype('float64'))
    bottom_down_dcape=(((np.array(df3[69:70])).flatten())[1:].astype('float64'))

    #Creating arrays to calculate the mean of arrays 

    ##Topers: 
    #upstream
    top_up_sfc_p_mean=np.mean(top_up_sfc_p[np.logical_not(np.isnan(top_up_sfc_p))])
    top_up_lcl_mean=np.mean(top_up_lcl[np.logical_not(np.isnan(top_up_lcl))])
    top_up_lfc_mean=np.mean(top_up_lfc[np.logical_not(np.isnan(top_up_lfc))])
    top_up_el_mean=np.mean(top_up_el[np.logical_not(np.isnan(top_up_el))])
    top_up_h0_mean=np.mean(top_up_h0[np.logical_not(np.isnan(top_up_h0))])
    top_up_h_neg20_mean=np.mean(top_up_h_neg20[np.logical_not(np.isnan(top_up_h_neg20))])
    top_up_wbzh_mean=np.mean(top_up_wbzh[np.logical_not(np.isnan(top_up_wbzh))])
    top_up_1km_srh_mean=np.mean(top_up_1km_srh[np.logical_not(np.isnan(top_up_1km_srh))])
    top_up_3km_srh_mean=np.mean(top_up_3km_srh[np.logical_not(np.isnan(top_up_3km_srh))])
    top_up_1km_shear_mean=np.mean(top_up_1km_shear[np.logical_not(np.isnan(top_up_1km_shear))])
    top_up_3km_shear_mean=np.mean(top_up_3km_shear[np.logical_not(np.isnan(top_up_3km_shear))])
    top_up_6km_shear_mean=np.mean(top_up_6km_shear[np.logical_not(np.isnan(top_up_6km_shear))])
    top_up_sbcape_mean=np.mean(top_up_sbcape[np.logical_not(np.isnan(top_up_sbcape))])
    top_up_mlcape_mean=np.mean(top_up_mlcape[np.logical_not(np.isnan(top_up_mlcape))])
    top_up_mucape_mean=np.mean(top_up_mucape[np.logical_not(np.isnan(top_up_mucape))])
    top_up_sbcin_mean=np.mean(top_up_sbcin[np.logical_not(np.isnan(top_up_sbcin))])
    top_up_mlcin_mean=np.mean(top_up_mlcin[np.logical_not(np.isnan(top_up_mlcin))])
    top_up_mucin_mean=np.mean(top_up_mucin[np.logical_not(np.isnan(top_up_mucin))])
    top_up_stp_mean=np.mean(top_up_stp[np.logical_not(np.isnan(top_up_stp))])
    top_up_scp_mean=np.mean(top_up_scp[np.logical_not(np.isnan(top_up_scp))])
    top_up_1km_lapse_mean=np.mean(top_up_1km_lapse[np.logical_not(np.isnan(top_up_1km_lapse))])
    top_up_2km_lapse_mean=np.mean(top_up_2km_lapse[np.logical_not(np.isnan(top_up_2km_lapse))])
    top_up_3km_lapse_mean=np.mean(top_up_3km_lapse[np.logical_not(np.isnan(top_up_3km_lapse))])
    top_up_6km_lapse_mean=np.mean(top_up_6km_lapse[np.logical_not(np.isnan(top_up_6km_lapse))])
    top_up_mid_rh_mean=np.mean(top_up_mid_rh[np.logical_not(np.isnan(top_up_mid_rh))])
    top_up_sherb_mean=np.mean(top_up_sherb[np.logical_not(np.isnan(top_up_sherb))])
    top_up_sfc_theta_mean=np.mean(top_up_sfc_theta[np.logical_not(np.isnan(top_up_sfc_theta))])
    top_up_ml_theta_mean=np.mean(top_up_ml_theta[np.logical_not(np.isnan(top_up_ml_theta))])
    top_up_dcape_mean=np.mean(top_up_dcape[np.logical_not(np.isnan(top_up_dcape))])
    #Peak
    top_peak_sfc_p_mean=np.mean(top_peak_sfc_p[np.logical_not(np.isnan(top_peak_sfc_p))])
    top_peak_lcl_mean=np.mean(top_peak_lcl[np.logical_not(np.isnan(top_peak_lcl))])
    top_peak_lfc_mean=np.mean(top_peak_lfc[np.logical_not(np.isnan(top_peak_lfc))])
    top_peak_el_mean=np.mean(top_peak_el[np.logical_not(np.isnan(top_peak_el))])
    top_peak_h0_mean=np.mean(top_peak_h0[np.logical_not(np.isnan(top_peak_h0))])
    top_peak_h_neg20_mean=np.mean(top_peak_h_neg20[np.logical_not(np.isnan(top_peak_h_neg20))])
    top_peak_wbzh_mean=np.mean(top_peak_wbzh[np.logical_not(np.isnan(top_peak_wbzh))])
    top_peak_1km_srh_mean=np.mean(top_peak_1km_srh[np.logical_not(np.isnan(top_peak_1km_srh))])
    top_peak_3km_srh_mean=np.mean(top_peak_3km_srh[np.logical_not(np.isnan(top_peak_3km_srh))])
    top_peak_1km_shear_mean=np.mean(top_peak_1km_shear[np.logical_not(np.isnan(top_peak_1km_shear))])
    top_peak_3km_shear_mean=np.mean(top_peak_3km_shear[np.logical_not(np.isnan(top_peak_3km_shear))])
    top_peak_6km_shear_mean=np.mean(top_peak_6km_shear[np.logical_not(np.isnan(top_peak_6km_shear))])
    top_peak_sbcape_mean=np.mean(top_peak_sbcape[np.logical_not(np.isnan(top_peak_sbcape))])
    top_peak_mlcape_mean=np.mean(top_peak_mlcape[np.logical_not(np.isnan(top_peak_mlcape))])
    top_peak_mucape_mean=np.mean(top_peak_mucape[np.logical_not(np.isnan(top_peak_mucape))])
    top_peak_sbcin_mean=np.mean(top_peak_sbcin[np.logical_not(np.isnan(top_peak_sbcin))])
    top_peak_mlcin_mean=np.mean(top_peak_mlcin[np.logical_not(np.isnan(top_peak_mlcin))])
    top_peak_mucin_mean=np.mean(top_peak_mucin[np.logical_not(np.isnan(top_peak_mucin))])
    top_peak_stp_mean=np.mean(top_peak_stp[np.logical_not(np.isnan(top_peak_stp))])
    top_peak_scp_mean=np.mean(top_peak_scp[np.logical_not(np.isnan(top_peak_scp))])
    top_peak_1km_lapse_mean=np.mean(top_peak_1km_lapse[np.logical_not(np.isnan(top_peak_1km_lapse))])
    top_peak_2km_lapse_mean=np.mean(top_peak_2km_lapse[np.logical_not(np.isnan(top_peak_2km_lapse))])
    top_peak_3km_lapse_mean=np.mean(top_peak_3km_lapse[np.logical_not(np.isnan(top_peak_3km_lapse))])
    top_peak_6km_lapse_mean=np.mean(top_peak_6km_lapse[np.logical_not(np.isnan(top_peak_6km_lapse))])
    top_peak_mid_rh_mean=np.mean(top_peak_mid_rh[np.logical_not(np.isnan(top_peak_mid_rh))])
    top_peak_sherb_mean=np.mean(top_peak_sherb[np.logical_not(np.isnan(top_peak_sherb))])
    top_peak_sfc_theta_mean=np.mean(top_peak_sfc_theta[np.logical_not(np.isnan(top_peak_sfc_theta))])
    top_peak_ml_theta_mean=np.mean(top_peak_ml_theta[np.logical_not(np.isnan(top_peak_ml_theta))])
    top_peak_dcape_mean=np.mean(top_peak_dcape[np.logical_not(np.isnan(top_peak_dcape))])
    #Downstream
    top_down_sfc_p_mean=np.mean(top_down_sfc_p[np.logical_not(np.isnan(top_down_sfc_p))])
    top_down_lcl_mean=np.mean(top_down_lcl[np.logical_not(np.isnan(top_down_lcl))])
    top_down_lfc_mean=np.mean(top_down_lfc[np.logical_not(np.isnan(top_down_lfc))])
    top_down_el_mean=np.mean(top_down_el[np.logical_not(np.isnan(top_down_el))])
    top_down_h0_mean=np.mean(top_down_h0[np.logical_not(np.isnan(top_down_h0))])
    top_down_h_neg20_mean=np.mean(top_down_h_neg20[np.logical_not(np.isnan(top_down_h_neg20))])
    top_down_wbzh_mean=np.mean(top_down_wbzh[np.logical_not(np.isnan(top_down_wbzh))])
    top_down_1km_srh_mean=np.mean(top_down_1km_srh[np.logical_not(np.isnan(top_down_1km_srh))])
    top_down_3km_srh_mean=np.mean(top_down_3km_srh[np.logical_not(np.isnan(top_down_3km_srh))])
    top_down_1km_shear_mean=np.mean(top_down_1km_shear[np.logical_not(np.isnan(top_down_1km_shear))])
    top_down_3km_shear_mean=np.mean(top_down_3km_shear[np.logical_not(np.isnan(top_down_3km_shear))])
    top_down_6km_shear_mean=np.mean(top_down_6km_shear[np.logical_not(np.isnan(top_down_6km_shear))])
    top_down_sbcape_mean=np.mean(top_down_sbcape[np.logical_not(np.isnan(top_down_sbcape))])
    top_down_mlcape_mean=np.mean(top_down_mlcape[np.logical_not(np.isnan(top_down_mlcape))])
    top_down_mucape_mean=np.mean(top_down_mucape[np.logical_not(np.isnan(top_down_mucape))])
    top_down_sbcin_mean=np.mean(top_down_sbcin[np.logical_not(np.isnan(top_down_sbcin))])
    top_down_mlcin_mean=np.mean(top_down_mlcin[np.logical_not(np.isnan(top_down_mlcin))])
    top_down_mucin_mean=np.mean(top_down_mucin[np.logical_not(np.isnan(top_down_mucin))])
    top_down_stp_mean=np.mean(top_down_stp[np.logical_not(np.isnan(top_down_stp))])
    top_down_scp_mean=np.mean(top_down_scp[np.logical_not(np.isnan(top_down_scp))])
    top_down_1km_lapse_mean=np.mean(top_down_1km_lapse[np.logical_not(np.isnan(top_down_1km_lapse))])
    top_down_2km_lapse_mean=np.mean(top_down_2km_lapse[np.logical_not(np.isnan(top_down_2km_lapse))])
    top_down_3km_lapse_mean=np.mean(top_down_3km_lapse[np.logical_not(np.isnan(top_down_3km_lapse))])
    top_down_6km_lapse_mean=np.mean(top_down_6km_lapse[np.logical_not(np.isnan(top_down_6km_lapse))])
    top_down_mid_rh_mean=np.mean(top_down_mid_rh[np.logical_not(np.isnan(top_down_mid_rh))])
    top_down_sherb_mean=np.mean(top_down_sherb[np.logical_not(np.isnan(top_down_sherb))])
    top_down_sfc_theta_mean=np.mean(top_down_sfc_theta[np.logical_not(np.isnan(top_down_sfc_theta))])
    top_down_ml_theta_mean=np.mean(top_down_ml_theta[np.logical_not(np.isnan(top_down_ml_theta))])
    top_down_dcape_mean=np.mean(top_down_dcape[np.logical_not(np.isnan(top_down_dcape))])

    ##Bottom-topers:
    #upstream
    bottom_up_sfc_p_mean=np.mean(bottom_up_sfc_p[np.logical_not(np.isnan(bottom_up_sfc_p))])
    bottom_up_lcl_mean=np.mean(bottom_up_lcl[np.logical_not(np.isnan(bottom_up_lcl))])
    bottom_up_lfc_mean=np.mean(bottom_up_lfc[np.logical_not(np.isnan(bottom_up_lfc))])
    bottom_up_el_mean=np.mean(bottom_up_el[np.logical_not(np.isnan(bottom_up_el))])
    bottom_up_h0_mean=np.mean(bottom_up_h0[np.logical_not(np.isnan(bottom_up_h0))])
    bottom_up_h_neg20_mean=np.mean(bottom_up_h_neg20[np.logical_not(np.isnan(bottom_up_h_neg20))])
    bottom_up_wbzh_mean=np.mean(bottom_up_wbzh[np.logical_not(np.isnan(bottom_up_wbzh))])
    bottom_up_1km_srh_mean=np.mean(bottom_up_1km_srh[np.logical_not(np.isnan(bottom_up_1km_srh))])
    bottom_up_3km_srh_mean=np.mean(bottom_up_3km_srh[np.logical_not(np.isnan(bottom_up_3km_srh))])
    bottom_up_1km_shear_mean=np.mean(bottom_up_1km_shear[np.logical_not(np.isnan(bottom_up_1km_shear))])
    bottom_up_3km_shear_mean=np.mean(bottom_up_3km_shear[np.logical_not(np.isnan(bottom_up_3km_shear))])
    bottom_up_6km_shear_mean=np.mean(bottom_up_6km_shear[np.logical_not(np.isnan(bottom_up_6km_shear))])
    bottom_up_sbcape_mean=np.mean(bottom_up_sbcape[np.logical_not(np.isnan(bottom_up_sbcape))])
    bottom_up_mlcape_mean=np.mean(bottom_up_mlcape[np.logical_not(np.isnan(bottom_up_mlcape))])
    bottom_up_mucape_mean=np.mean(bottom_up_mucape[np.logical_not(np.isnan(bottom_up_mucape))])
    bottom_up_sbcin_mean=np.mean(bottom_up_sbcin[np.logical_not(np.isnan(bottom_up_sbcin))])
    bottom_up_mlcin_mean=np.mean(bottom_up_mlcin[np.logical_not(np.isnan(bottom_up_mlcin))])
    bottom_up_mucin_mean=np.mean(bottom_up_mucin[np.logical_not(np.isnan(bottom_up_mucin))])
    bottom_up_stp_mean=np.mean(bottom_up_stp[np.logical_not(np.isnan(bottom_up_stp))])
    bottom_up_scp_mean=np.mean(bottom_up_scp[np.logical_not(np.isnan(bottom_up_scp))])
    bottom_up_1km_lapse_mean=np.mean(bottom_up_1km_lapse[np.logical_not(np.isnan(bottom_up_1km_lapse))])
    bottom_up_2km_lapse_mean=np.mean(bottom_up_2km_lapse[np.logical_not(np.isnan(bottom_up_2km_lapse))])
    bottom_up_3km_lapse_mean=np.mean(bottom_up_3km_lapse[np.logical_not(np.isnan(bottom_up_3km_lapse))])
    bottom_up_6km_lapse_mean=np.mean(bottom_up_6km_lapse[np.logical_not(np.isnan(bottom_up_6km_lapse))])
    bottom_up_mid_rh_mean=np.mean(bottom_up_mid_rh[np.logical_not(np.isnan(bottom_up_mid_rh))])
    bottom_up_sherb_mean=np.mean(bottom_up_sherb[np.logical_not(np.isnan(bottom_up_sherb))])
    bottom_up_sfc_theta_mean=np.mean(bottom_up_sfc_theta[np.logical_not(np.isnan(bottom_up_sfc_theta))])
    bottom_up_ml_theta_mean=np.mean(bottom_up_ml_theta[np.logical_not(np.isnan(bottom_up_ml_theta))])
    bottom_up_dcape_mean=np.mean(bottom_up_dcape[np.logical_not(np.isnan(bottom_up_dcape))])
    #Peak
    bottom_peak_sfc_p_mean=np.mean(bottom_peak_sfc_p[np.logical_not(np.isnan(bottom_peak_sfc_p))])
    bottom_peak_lcl_mean=np.mean(bottom_peak_lcl[np.logical_not(np.isnan(bottom_peak_lcl))])
    bottom_peak_lfc_mean=np.mean(bottom_peak_lfc[np.logical_not(np.isnan(bottom_peak_lfc))])
    bottom_peak_el_mean=np.mean(bottom_peak_el[np.logical_not(np.isnan(bottom_peak_el))])
    bottom_peak_h0_mean=np.mean(bottom_peak_h0[np.logical_not(np.isnan(bottom_peak_h0))])
    bottom_peak_h_neg20_mean=np.mean(bottom_peak_h_neg20[np.logical_not(np.isnan(bottom_peak_h_neg20))])
    bottom_peak_wbzh_mean=np.mean(bottom_peak_wbzh[np.logical_not(np.isnan(bottom_peak_wbzh))])
    bottom_peak_1km_srh_mean=np.mean(bottom_peak_1km_srh[np.logical_not(np.isnan(bottom_peak_1km_srh))])
    bottom_peak_3km_srh_mean=np.mean(bottom_peak_3km_srh[np.logical_not(np.isnan(bottom_peak_3km_srh))])
    bottom_peak_1km_shear_mean=np.mean(bottom_peak_1km_shear[np.logical_not(np.isnan(bottom_peak_1km_shear))])
    bottom_peak_3km_shear_mean=np.mean(bottom_peak_3km_shear[np.logical_not(np.isnan(bottom_peak_3km_shear))])
    bottom_peak_6km_shear_mean=np.mean(bottom_peak_6km_shear[np.logical_not(np.isnan(bottom_peak_6km_shear))])
    bottom_peak_sbcape_mean=np.mean(bottom_peak_sbcape[np.logical_not(np.isnan(bottom_peak_sbcape))])
    bottom_peak_mlcape_mean=np.mean(bottom_peak_mlcape[np.logical_not(np.isnan(bottom_peak_mlcape))])
    bottom_peak_mucape_mean=np.mean(bottom_peak_mucape[np.logical_not(np.isnan(bottom_peak_mucape))])
    bottom_peak_sbcin_mean=np.mean(bottom_peak_sbcin[np.logical_not(np.isnan(bottom_peak_sbcin))])
    bottom_peak_mlcin_mean=np.mean(bottom_peak_mlcin[np.logical_not(np.isnan(bottom_peak_mlcin))])
    bottom_peak_mucin_mean=np.mean(bottom_peak_mucin[np.logical_not(np.isnan(bottom_peak_mucin))])
    bottom_peak_stp_mean=np.mean(bottom_peak_stp[np.logical_not(np.isnan(bottom_peak_stp))])
    bottom_peak_scp_mean=np.mean(bottom_peak_scp[np.logical_not(np.isnan(bottom_peak_scp))])
    bottom_peak_1km_lapse_mean=np.mean(bottom_peak_1km_lapse[np.logical_not(np.isnan(bottom_peak_1km_lapse))])
    bottom_peak_2km_lapse_mean=np.mean(bottom_peak_2km_lapse[np.logical_not(np.isnan(bottom_peak_2km_lapse))])
    bottom_peak_3km_lapse_mean=np.mean(bottom_peak_3km_lapse[np.logical_not(np.isnan(bottom_peak_3km_lapse))])
    bottom_peak_6km_lapse_mean=np.mean(bottom_peak_6km_lapse[np.logical_not(np.isnan(bottom_peak_6km_lapse))])
    bottom_peak_mid_rh_mean=np.mean(bottom_peak_mid_rh[np.logical_not(np.isnan(bottom_peak_mid_rh))])
    bottom_peak_sherb_mean=np.mean(bottom_peak_sherb[np.logical_not(np.isnan(bottom_peak_sherb))])
    bottom_peak_sfc_theta_mean=np.mean(bottom_peak_sfc_theta[np.logical_not(np.isnan(bottom_peak_sfc_theta))])
    bottom_peak_ml_theta_mean=np.mean(bottom_peak_ml_theta[np.logical_not(np.isnan(bottom_peak_ml_theta))])
    bottom_peak_dcape_mean=np.mean(bottom_peak_dcape[np.logical_not(np.isnan(bottom_peak_dcape))])
    #Downstream
    bottom_down_sfc_p_mean=np.mean(bottom_down_sfc_p[np.logical_not(np.isnan(bottom_down_sfc_p))])
    bottom_down_lcl_mean=np.mean(bottom_down_lcl[np.logical_not(np.isnan(bottom_down_lcl))])
    bottom_down_lfc_mean=np.mean(bottom_down_lfc[np.logical_not(np.isnan(bottom_down_lfc))])
    bottom_down_el_mean=np.mean(bottom_down_el[np.logical_not(np.isnan(bottom_down_el))])
    bottom_down_h0_mean=np.mean(bottom_down_h0[np.logical_not(np.isnan(bottom_down_h0))])
    bottom_down_h_neg20_mean=np.mean(bottom_down_h_neg20[np.logical_not(np.isnan(bottom_down_h_neg20))])
    bottom_down_wbzh_mean=np.mean(bottom_down_wbzh[np.logical_not(np.isnan(bottom_down_wbzh))])
    bottom_down_1km_srh_mean=np.mean(bottom_down_1km_srh[np.logical_not(np.isnan(bottom_down_1km_srh))])
    bottom_down_3km_srh_mean=np.mean(bottom_down_3km_srh[np.logical_not(np.isnan(bottom_down_3km_srh))])
    bottom_down_1km_shear_mean=np.mean(bottom_down_1km_shear[np.logical_not(np.isnan(bottom_down_1km_shear))])
    bottom_down_3km_shear_mean=np.mean(bottom_down_3km_shear[np.logical_not(np.isnan(bottom_down_3km_shear))])
    bottom_down_6km_shear_mean=np.mean(bottom_down_6km_shear[np.logical_not(np.isnan(bottom_down_6km_shear))])
    bottom_down_sbcape_mean=np.mean(bottom_down_sbcape[np.logical_not(np.isnan(bottom_down_sbcape))])
    bottom_down_mlcape_mean=np.mean(bottom_down_mlcape[np.logical_not(np.isnan(bottom_down_mlcape))])
    bottom_down_mucape_mean=np.mean(bottom_down_mucape[np.logical_not(np.isnan(bottom_down_mucape))])
    bottom_down_sbcin_mean=np.mean(bottom_down_sbcin[np.logical_not(np.isnan(bottom_down_sbcin))])
    bottom_down_mlcin_mean=np.mean(bottom_down_mlcin[np.logical_not(np.isnan(bottom_down_mlcin))])
    bottom_down_mucin_mean=np.mean(bottom_down_mucin[np.logical_not(np.isnan(bottom_down_mucin))])
    bottom_down_stp_mean=np.mean(bottom_down_stp[np.logical_not(np.isnan(bottom_down_stp))])
    bottom_down_scp_mean=np.mean(bottom_down_scp[np.logical_not(np.isnan(bottom_down_scp))])
    bottom_down_1km_lapse_mean=np.mean(bottom_down_1km_lapse[np.logical_not(np.isnan(bottom_down_1km_lapse))])
    bottom_down_2km_lapse_mean=np.mean(bottom_down_2km_lapse[np.logical_not(np.isnan(bottom_down_2km_lapse))])
    bottom_down_3km_lapse_mean=np.mean(bottom_down_3km_lapse[np.logical_not(np.isnan(bottom_down_3km_lapse))])
    bottom_down_6km_lapse_mean=np.mean(bottom_down_6km_lapse[np.logical_not(np.isnan(bottom_down_6km_lapse))])
    bottom_down_mid_rh_mean=np.mean(bottom_down_mid_rh[np.logical_not(np.isnan(bottom_down_mid_rh))])
    bottom_down_sherb_mean=np.mean(bottom_down_sherb[np.logical_not(np.isnan(bottom_down_sherb))])
    bottom_down_sfc_theta_mean=np.mean(bottom_down_sfc_theta[np.logical_not(np.isnan(bottom_down_sfc_theta))])
    bottom_down_ml_theta_mean=np.mean(bottom_down_ml_theta[np.logical_not(np.isnan(bottom_down_ml_theta))])
    bottom_down_dcape_mean=np.mean(bottom_down_dcape[np.logical_not(np.isnan(bottom_down_dcape))])

   #Calculating the KS stats and p-values 
    #Upstream
    up_lcl_ks,up_lcl_pvalue=(stats.ks_2samp(top_up_lcl[np.isfinite(top_up_lcl)], 
                                            bottom_up_lcl[np.isfinite(bottom_up_lcl)]))
    up_lfc_ks,up_lfc_pvalue=(stats.ks_2samp(top_up_lfc[np.isfinite(top_up_lfc)], 
                                            bottom_up_lfc[np.isfinite(bottom_up_lfc)]))
    up_el_ks,up_el_pvalue=(stats.ks_2samp(top_up_el[np.isfinite(top_up_el)], 
                                          bottom_up_el[np.isfinite(bottom_up_el)]))
    up_h0_ks,up_h0_pvalue=(stats.ks_2samp(top_up_h0[np.isfinite(top_up_h0)],
                                          bottom_up_h0[np.isfinite(bottom_up_h0)]))
    up_h_neg20_ks,up_h_neg20_pvalue=(stats.ks_2samp(top_up_h_neg20[np.isfinite(top_up_h_neg20)], 
                                                    bottom_up_h_neg20[np.isfinite(bottom_up_h_neg20)]))
    up_wbzh_ks,up_wbzh_pvalue=(stats.ks_2samp(top_up_wbzh[np.isfinite(top_up_wbzh)], 
                                              bottom_up_wbzh[np.isfinite(bottom_up_wbzh)]))
    up_1km_srh_ks,up_1km_srh_pvalue=(stats.ks_2samp(top_up_1km_srh[np.isfinite(top_up_1km_srh)],
                                                    bottom_up_1km_srh[np.isfinite(bottom_up_1km_srh)]))
    up_3km_srh_ks,up_3km_srh_pvalue=(stats.ks_2samp(top_up_3km_srh[np.isfinite(top_up_3km_srh)],
                                                    bottom_up_3km_srh[np.isfinite(bottom_up_3km_srh)]))
    up_1km_shear_ks,up_1km_shear_pvalue=(stats.ks_2samp(top_up_1km_shear[np.isfinite(top_up_1km_shear)],
                                                    bottom_up_1km_shear[np.isfinite(bottom_up_1km_shear)]))
    up_3km_shear_ks,up_3km_shear_pvalue=(stats.ks_2samp(top_up_3km_shear[np.isfinite(top_up_3km_shear)],
                                                    bottom_up_3km_shear[np.isfinite(bottom_up_3km_shear)]))
    up_6km_shear_ks,up_6km_shear_pvalue=(stats.ks_2samp(top_up_6km_shear[np.isfinite(top_up_6km_shear)],
                                                    bottom_up_6km_shear[np.isfinite(bottom_up_6km_shear)]))
    up_sbcape_ks,up_sbcape_pvalue=(stats.ks_2samp(top_up_sbcape[np.isfinite(top_up_sbcape)],
                                                    bottom_up_sbcape[np.isfinite(bottom_up_sbcape)]))
    up_mlcape_ks,up_mlcape_pvalue=(stats.ks_2samp(top_up_mlcape[np.isfinite(top_up_mlcape)],
                                                    bottom_up_mlcape[np.isfinite(bottom_up_mlcape)]))
    up_mucape_ks,up_mucape_pvalue=(stats.ks_2samp(top_up_mucape[np.isfinite(top_up_mucape)],
                                                    bottom_up_mucape[np.isfinite(bottom_up_mucape)]))
    up_sbcin_ks,up_sbcin_pvalue=(stats.ks_2samp(top_up_sbcin[np.isfinite(top_up_sbcin)],
                                                    bottom_up_sbcin[np.isfinite(bottom_up_sbcin)]))
    up_mlcin_ks,up_mlcin_pvalue=(stats.ks_2samp(top_up_mlcin[np.isfinite(top_up_mlcin)],
                                                    bottom_up_mlcin[np.isfinite(bottom_up_mlcin)]))
    up_mucin_ks,up_mucin_pvalue=(stats.ks_2samp(top_up_mucin[np.isfinite(top_up_mucin)],
                                                    bottom_up_mucin[np.isfinite(bottom_up_mucin)]))
    up_stp_ks,up_stp_pvalue=(stats.ks_2samp(top_up_stp[np.isfinite(top_up_stp)],
                                                    bottom_up_stp[np.isfinite(bottom_up_stp)]))
    up_scp_ks,up_scp_pvalue=(stats.ks_2samp(top_up_scp[np.isfinite(top_up_scp)],
                                                    bottom_up_scp[np.isfinite(bottom_up_scp)]))
    up_sherb_ks,up_sherb_pvalue=(stats.ks_2samp(top_up_sherb[np.isfinite(top_up_sherb)],
                                                    bottom_up_sherb[np.isfinite(bottom_up_sherb)]))
    up_1km_lapse_ks,up_1km_lapse_pvalue=(stats.ks_2samp(top_up_1km_lapse[np.isfinite(top_up_1km_lapse)],
                                                    bottom_up_1km_lapse[np.isfinite(bottom_up_1km_lapse)]))
    up_2km_lapse_ks,up_2km_lapse_pvalue=(stats.ks_2samp(top_up_2km_lapse[np.isfinite(top_up_2km_lapse)],
                                                    bottom_up_2km_lapse[np.isfinite(bottom_up_2km_lapse)]))
    up_3km_lapse_ks,up_3km_lapse_pvalue=(stats.ks_2samp(top_up_3km_lapse[np.isfinite(top_up_3km_lapse)],
                                                    bottom_up_3km_lapse[np.isfinite(bottom_up_3km_lapse)]))
    up_6km_lapse_ks,up_6km_lapse_pvalue=(stats.ks_2samp(top_up_6km_lapse[np.isfinite(top_up_6km_lapse)],
                                                    bottom_up_6km_lapse[np.isfinite(bottom_up_6km_lapse)]))
    up_mid_rh_ks,up_mid_rh_pvalue=(stats.ks_2samp(top_up_mid_rh[np.isfinite(top_up_mid_rh)],
                                                    bottom_up_mid_rh[np.isfinite(bottom_up_mid_rh)]))
    up_sfc_theta_ks,up_sfc_theta_pvalue=(stats.ks_2samp(top_up_sfc_theta[np.isfinite(top_up_sfc_theta)],
                                                    bottom_up_sfc_theta[np.isfinite(bottom_up_sfc_theta)]))
    up_ml_theta_ks,up_ml_theta_pvalue=(stats.ks_2samp(top_up_ml_theta[np.isfinite(top_up_ml_theta)],
                                                    bottom_up_ml_theta[np.isfinite(bottom_up_ml_theta)]))
    up_dcape_ks,up_dcape_pvalue=(stats.ks_2samp(top_up_dcape[np.isfinite(top_up_dcape)],
                                                    bottom_up_dcape[np.isfinite(bottom_up_dcape)]))
    
    #Peak
    peak_lcl_ks,peak_lcl_pvalue=(stats.ks_2samp(top_peak_lcl[np.isfinite(top_peak_lcl)], 
                                            bottom_peak_lcl[np.isfinite(bottom_peak_lcl)]))
    peak_lfc_ks,peak_lfc_pvalue=(stats.ks_2samp(top_peak_lfc[np.isfinite(top_peak_lfc)], 
                                            bottom_peak_lfc[np.isfinite(bottom_peak_lfc)]))
    peak_el_ks,peak_el_pvalue=(stats.ks_2samp(top_peak_el[np.isfinite(top_peak_el)], 
                                          bottom_peak_el[np.isfinite(bottom_peak_el)]))
    peak_h0_ks,peak_h0_pvalue=(stats.ks_2samp(top_peak_h0[np.isfinite(top_peak_h0)],
                                          bottom_peak_h0[np.isfinite(bottom_peak_h0)]))
    peak_h_neg20_ks,peak_h_neg20_pvalue=(stats.ks_2samp(top_peak_h_neg20[np.isfinite(top_peak_h_neg20)], 
                                                    bottom_peak_h_neg20[np.isfinite(bottom_peak_h_neg20)]))
    peak_wbzh_ks,peak_wbzh_pvalue=(stats.ks_2samp(top_peak_wbzh[np.isfinite(top_peak_wbzh)], 
                                              bottom_peak_wbzh[np.isfinite(bottom_peak_wbzh)]))
    peak_1km_srh_ks,peak_1km_srh_pvalue=(stats.ks_2samp(top_peak_1km_srh[np.isfinite(top_peak_1km_srh)],
                                                    bottom_peak_1km_srh[np.isfinite(bottom_peak_1km_srh)]))
    peak_3km_srh_ks,peak_3km_srh_pvalue=(stats.ks_2samp(top_peak_3km_srh[np.isfinite(top_peak_3km_srh)],
                                                    bottom_peak_3km_srh[np.isfinite(bottom_peak_3km_srh)]))
    peak_1km_shear_ks,peak_1km_shear_pvalue=(stats.ks_2samp(top_peak_1km_shear[np.isfinite(top_peak_1km_shear)],
                                                    bottom_peak_1km_shear[np.isfinite(bottom_peak_1km_shear)]))
    peak_3km_shear_ks,peak_3km_shear_pvalue=(stats.ks_2samp(top_peak_3km_shear[np.isfinite(top_peak_3km_shear)],
                                                    bottom_peak_3km_shear[np.isfinite(bottom_peak_3km_shear)]))
    peak_6km_shear_ks,peak_6km_shear_pvalue=(stats.ks_2samp(top_peak_6km_shear[np.isfinite(top_peak_6km_shear)],
                                                    bottom_peak_6km_shear[np.isfinite(bottom_peak_6km_shear)]))
    peak_sbcape_ks,peak_sbcape_pvalue=(stats.ks_2samp(top_peak_sbcape[np.isfinite(top_peak_sbcape)],
                                                    bottom_peak_sbcape[np.isfinite(bottom_peak_sbcape)]))
    peak_mlcape_ks,peak_mlcape_pvalue=(stats.ks_2samp(top_peak_mlcape[np.isfinite(top_peak_mlcape)],
                                                    bottom_peak_mlcape[np.isfinite(bottom_peak_mlcape)]))
    peak_mucape_ks,peak_mucape_pvalue=(stats.ks_2samp(top_peak_mucape[np.isfinite(top_peak_mucape)],
                                                    bottom_peak_mucape[np.isfinite(bottom_peak_mucape)]))
    peak_sbcin_ks,peak_sbcin_pvalue=(stats.ks_2samp(top_peak_sbcin[np.isfinite(top_peak_sbcin)],
                                                    bottom_peak_sbcin[np.isfinite(bottom_peak_sbcin)]))
    peak_mlcin_ks,peak_mlcin_pvalue=(stats.ks_2samp(top_peak_mlcin[np.isfinite(top_peak_mlcin)],
                                                    bottom_peak_mlcin[np.isfinite(bottom_peak_mlcin)]))
    peak_mucin_ks,peak_mucin_pvalue=(stats.ks_2samp(top_peak_mucin[np.isfinite(top_peak_mucin)],
                                                    bottom_peak_mucin[np.isfinite(bottom_peak_mucin)]))
    peak_stp_ks,peak_stp_pvalue=(stats.ks_2samp(top_peak_stp[np.isfinite(top_peak_stp)],
                                                    bottom_peak_stp[np.isfinite(bottom_peak_stp)]))
    peak_scp_ks,peak_scp_pvalue=(stats.ks_2samp(top_peak_scp[np.isfinite(top_peak_scp)],
                                                    bottom_peak_scp[np.isfinite(bottom_peak_scp)]))
    peak_sherb_ks,peak_sherb_pvalue=(stats.ks_2samp(top_peak_sherb[np.isfinite(top_peak_sherb)],
                                                    bottom_peak_sherb[np.isfinite(bottom_peak_sherb)]))
    peak_1km_lapse_ks,peak_1km_lapse_pvalue=(stats.ks_2samp(top_peak_1km_lapse[np.isfinite(top_peak_1km_lapse)],
                                                    bottom_peak_1km_lapse[np.isfinite(bottom_peak_1km_lapse)]))
    peak_2km_lapse_ks,peak_2km_lapse_pvalue=(stats.ks_2samp(top_peak_2km_lapse[np.isfinite(top_peak_2km_lapse)],
                                                    bottom_peak_2km_lapse[np.isfinite(bottom_peak_2km_lapse)]))
    peak_3km_lapse_ks,peak_3km_lapse_pvalue=(stats.ks_2samp(top_peak_3km_lapse[np.isfinite(top_peak_3km_lapse)],
                                                    bottom_peak_3km_lapse[np.isfinite(bottom_peak_3km_lapse)]))
    peak_6km_lapse_ks,peak_6km_lapse_pvalue=(stats.ks_2samp(top_peak_6km_lapse[np.isfinite(top_peak_6km_lapse)],
                                                    bottom_peak_6km_lapse[np.isfinite(bottom_peak_6km_lapse)]))
    peak_mid_rh_ks,peak_mid_rh_pvalue=(stats.ks_2samp(top_peak_mid_rh[np.isfinite(top_peak_mid_rh)],
                                                    bottom_peak_mid_rh[np.isfinite(bottom_peak_mid_rh)]))
    peak_sfc_theta_ks,peak_sfc_theta_pvalue=(stats.ks_2samp(top_peak_sfc_theta[np.isfinite(top_peak_sfc_theta)],
                                                    bottom_peak_sfc_theta[np.isfinite(bottom_peak_sfc_theta)]))
    peak_ml_theta_ks,peak_ml_theta_pvalue=(stats.ks_2samp(top_peak_ml_theta[np.isfinite(top_peak_ml_theta)],
                                                    bottom_peak_ml_theta[np.isfinite(bottom_peak_ml_theta)]))
    peak_dcape_ks,peak_dcape_pvalue=(stats.ks_2samp(top_peak_dcape[np.isfinite(top_peak_dcape)],
                                                    bottom_peak_dcape[np.isfinite(bottom_peak_dcape)]))

    #Downstream
    down_lcl_ks,down_lcl_pvalue=(stats.ks_2samp(top_down_lcl[np.isfinite(top_down_lcl)], 
                                            bottom_down_lcl[np.isfinite(bottom_down_lcl)]))
    down_lfc_ks,down_lfc_pvalue=(stats.ks_2samp(top_down_lfc[np.isfinite(top_down_lfc)], 
                                            bottom_down_lfc[np.isfinite(bottom_down_lfc)]))
    down_el_ks,down_el_pvalue=(stats.ks_2samp(top_down_el[np.isfinite(top_down_el)], 
                                          bottom_down_el[np.isfinite(bottom_down_el)]))
    down_h0_ks,down_h0_pvalue=(stats.ks_2samp(top_down_h0[np.isfinite(top_down_h0)],
                                          bottom_down_h0[np.isfinite(bottom_down_h0)]))
    down_h_neg20_ks,down_h_neg20_pvalue=(stats.ks_2samp(top_down_h_neg20[np.isfinite(top_down_h_neg20)], 
                                                    bottom_down_h_neg20[np.isfinite(bottom_down_h_neg20)]))
    down_wbzh_ks,down_wbzh_pvalue=(stats.ks_2samp(top_down_wbzh[np.isfinite(top_down_wbzh)], 
                                              bottom_down_wbzh[np.isfinite(bottom_down_wbzh)]))
    down_1km_srh_ks,down_1km_srh_pvalue=(stats.ks_2samp(top_down_1km_srh[np.isfinite(top_down_1km_srh)],
                                                    bottom_down_1km_srh[np.isfinite(bottom_down_1km_srh)]))
    down_3km_srh_ks,down_3km_srh_pvalue=(stats.ks_2samp(top_down_3km_srh[np.isfinite(top_down_3km_srh)],
                                                    bottom_down_3km_srh[np.isfinite(bottom_down_3km_srh)]))
    down_1km_shear_ks,down_1km_shear_pvalue=(stats.ks_2samp(top_down_1km_shear[np.isfinite(top_down_1km_shear)],
                                                    bottom_down_1km_shear[np.isfinite(bottom_down_1km_shear)]))
    down_3km_shear_ks,down_3km_shear_pvalue=(stats.ks_2samp(top_down_3km_shear[np.isfinite(top_down_3km_shear)],
                                                    bottom_down_3km_shear[np.isfinite(bottom_down_3km_shear)]))
    down_6km_shear_ks,down_6km_shear_pvalue=(stats.ks_2samp(top_down_6km_shear[np.isfinite(top_down_6km_shear)],
                                                    bottom_down_6km_shear[np.isfinite(bottom_down_6km_shear)]))
    down_sbcape_ks,down_sbcape_pvalue=(stats.ks_2samp(top_down_sbcape[np.isfinite(top_down_sbcape)],
                                                    bottom_down_sbcape[np.isfinite(bottom_down_sbcape)]))
    down_mlcape_ks,down_mlcape_pvalue=(stats.ks_2samp(top_down_mlcape[np.isfinite(top_down_mlcape)],
                                                    bottom_down_mlcape[np.isfinite(bottom_down_mlcape)]))
    down_mucape_ks,down_mucape_pvalue=(stats.ks_2samp(top_down_mucape[np.isfinite(top_down_mucape)],
                                                    bottom_down_mucape[np.isfinite(bottom_down_mucape)]))
    down_sbcin_ks,down_sbcin_pvalue=(stats.ks_2samp(top_down_sbcin[np.isfinite(top_down_sbcin)],
                                                    bottom_down_sbcin[np.isfinite(bottom_down_sbcin)]))
    down_mlcin_ks,down_mlcin_pvalue=(stats.ks_2samp(top_down_mlcin[np.isfinite(top_down_mlcin)],
                                                    bottom_down_mlcin[np.isfinite(bottom_down_mlcin)]))
    down_mucin_ks,down_mucin_pvalue=(stats.ks_2samp(top_down_mucin[np.isfinite(top_down_mucin)],
                                                    bottom_down_mucin[np.isfinite(bottom_down_mucin)]))
    down_stp_ks,down_stp_pvalue=(stats.ks_2samp(top_down_stp[np.isfinite(top_down_stp)],
                                                    bottom_down_stp[np.isfinite(bottom_down_stp)]))
    down_scp_ks,down_scp_pvalue=(stats.ks_2samp(top_down_scp[np.isfinite(top_down_scp)],
                                                    bottom_down_scp[np.isfinite(bottom_down_scp)]))
    down_sherb_ks,down_sherb_pvalue=(stats.ks_2samp(top_down_sherb[np.isfinite(top_down_sherb)],
                                                    bottom_down_sherb[np.isfinite(bottom_down_sherb)]))
    down_1km_lapse_ks,down_1km_lapse_pvalue=(stats.ks_2samp(top_down_1km_lapse[np.isfinite(top_down_1km_lapse)],
                                                    bottom_down_1km_lapse[np.isfinite(bottom_down_1km_lapse)]))
    down_2km_lapse_ks,down_2km_lapse_pvalue=(stats.ks_2samp(top_down_2km_lapse[np.isfinite(top_down_2km_lapse)],
                                                    bottom_down_2km_lapse[np.isfinite(bottom_down_2km_lapse)]))
    down_3km_lapse_ks,down_3km_lapse_pvalue=(stats.ks_2samp(top_down_3km_lapse[np.isfinite(top_down_3km_lapse)],
                                                    bottom_down_3km_lapse[np.isfinite(bottom_down_3km_lapse)]))
    down_6km_lapse_ks,down_6km_lapse_pvalue=(stats.ks_2samp(top_down_6km_lapse[np.isfinite(top_down_6km_lapse)],
                                                    bottom_down_6km_lapse[np.isfinite(bottom_down_6km_lapse)]))
    down_mid_rh_ks,down_mid_rh_pvalue=(stats.ks_2samp(top_down_mid_rh[np.isfinite(top_down_mid_rh)],
                                                    bottom_down_mid_rh[np.isfinite(bottom_down_mid_rh)]))
    down_sfc_theta_ks,down_sfc_theta_pvalue=(stats.ks_2samp(top_down_sfc_theta[np.isfinite(top_down_sfc_theta)],
                                                    bottom_down_sfc_theta[np.isfinite(bottom_down_sfc_theta)]))
    down_ml_theta_ks,down_ml_theta_pvalue=(stats.ks_2samp(top_down_ml_theta[np.isfinite(top_down_ml_theta)],
                                                    bottom_down_ml_theta[np.isfinite(bottom_down_ml_theta)]))
    down_dcape_ks,down_dcape_pvalue=(stats.ks_2samp(top_down_dcape[np.isfinite(top_down_dcape)],
                                                    bottom_down_dcape[np.isfinite(bottom_down_dcape)]))

    #Calculating the welchs stats and p-values 
    #Upstream
    up_lcl_t,up_lcl_pvalue_t=(stats.ttest_ind(top_up_lcl[np.isfinite(top_up_lcl)], 
                                            bottom_up_lcl[np.isfinite(bottom_up_lcl)]))
    up_lfc_t,up_lfc_pvalue_t=(stats.ttest_ind(top_up_lfc[np.isfinite(top_up_lfc)], 
                                            bottom_up_lfc[np.isfinite(bottom_up_lfc)]))
    up_el_t,up_el_pvalue_t=(stats.ttest_ind(top_up_el[np.isfinite(top_up_el)], 
                                          bottom_up_el[np.isfinite(bottom_up_el)]))
    up_h0_t,up_h0_pvalue_t=(stats.ttest_ind(top_up_h0[np.isfinite(top_up_h0)],
                                          bottom_up_h0[np.isfinite(bottom_up_h0)]))
    up_h_neg20_t,up_h_neg20_pvalue_t=(stats.ttest_ind(top_up_h_neg20[np.isfinite(top_up_h_neg20)], 
                                                    bottom_up_h_neg20[np.isfinite(bottom_up_h_neg20)]))
    up_wbzh_t,up_wbzh_pvalue_t=(stats.ttest_ind(top_up_wbzh[np.isfinite(top_up_wbzh)], 
                                              bottom_up_wbzh[np.isfinite(bottom_up_wbzh)]))
    up_1km_srh_t,up_1km_srh_pvalue_t=(stats.ttest_ind(top_up_1km_srh[np.isfinite(top_up_1km_srh)],
                                                    bottom_up_1km_srh[np.isfinite(bottom_up_1km_srh)]))
    up_3km_srh_t,up_3km_srh_pvalue_t=(stats.ttest_ind(top_up_3km_srh[np.isfinite(top_up_3km_srh)],
                                                    bottom_up_3km_srh[np.isfinite(bottom_up_3km_srh)]))
    up_1km_shear_t,up_1km_shear_pvalue_t=(stats.ttest_ind(top_up_1km_shear[np.isfinite(top_up_1km_shear)],
                                                    bottom_up_1km_shear[np.isfinite(bottom_up_1km_shear)]))
    up_3km_shear_t,up_3km_shear_pvalue_t=(stats.ttest_ind(top_up_3km_shear[np.isfinite(top_up_3km_shear)],
                                                    bottom_up_3km_shear[np.isfinite(bottom_up_3km_shear)]))
    up_6km_shear_t,up_6km_shear_pvalue_t=(stats.ttest_ind(top_up_6km_shear[np.isfinite(top_up_6km_shear)],
                                                    bottom_up_6km_shear[np.isfinite(bottom_up_6km_shear)]))
    up_sbcape_t,up_sbcape_pvalue_t=(stats.ttest_ind(top_up_sbcape[np.isfinite(top_up_sbcape)],
                                                    bottom_up_sbcape[np.isfinite(bottom_up_sbcape)]))
    up_mlcape_t,up_mlcape_pvalue_t=(stats.ttest_ind(top_up_mlcape[np.isfinite(top_up_mlcape)],
                                                    bottom_up_mlcape[np.isfinite(bottom_up_mlcape)]))
    up_mucape_t,up_mucape_pvalue_t=(stats.ttest_ind(top_up_mucape[np.isfinite(top_up_mucape)],
                                                    bottom_up_mucape[np.isfinite(bottom_up_mucape)]))
    up_sbcin_t,up_sbcin_pvalue_t=(stats.ttest_ind(top_up_sbcin[np.isfinite(top_up_sbcin)],
                                                    bottom_up_sbcin[np.isfinite(bottom_up_sbcin)]))
    up_mlcin_t,up_mlcin_pvalue_t=(stats.ttest_ind(top_up_mlcin[np.isfinite(top_up_mlcin)],
                                                    bottom_up_mlcin[np.isfinite(bottom_up_mlcin)]))
    up_mucin_t,up_mucin_pvalue_t=(stats.ttest_ind(top_up_mucin[np.isfinite(top_up_mucin)],
                                                    bottom_up_mucin[np.isfinite(bottom_up_mucin)]))
    up_stp_t,up_stp_pvalue_t=(stats.ttest_ind(top_up_stp[np.isfinite(top_up_stp)],
                                                    bottom_up_stp[np.isfinite(bottom_up_stp)]))
    up_scp_t,up_scp_pvalue_t=(stats.ttest_ind(top_up_scp[np.isfinite(top_up_scp)],
                                                    bottom_up_scp[np.isfinite(bottom_up_scp)]))
    up_sherb_t,up_sherb_pvalue_t=(stats.ttest_ind(top_up_sherb[np.isfinite(top_up_sherb)],
                                                    bottom_up_sherb[np.isfinite(bottom_up_sherb)]))
    up_1km_lapse_t,up_1km_lapse_pvalue_t=(stats.ttest_ind(top_up_1km_lapse[np.isfinite(top_up_1km_lapse)],
                                                    bottom_up_1km_lapse[np.isfinite(bottom_up_1km_lapse)]))
    up_2km_lapse_t,up_2km_lapse_pvalue_t=(stats.ttest_ind(top_up_2km_lapse[np.isfinite(top_up_2km_lapse)],
                                                    bottom_up_2km_lapse[np.isfinite(bottom_up_2km_lapse)]))
    up_3km_lapse_t,up_3km_lapse_pvalue_t=(stats.ttest_ind(top_up_3km_lapse[np.isfinite(top_up_3km_lapse)],
                                                    bottom_up_3km_lapse[np.isfinite(bottom_up_3km_lapse)]))
    up_6km_lapse_t,up_6km_lapse_pvalue_t=(stats.ttest_ind(top_up_6km_lapse[np.isfinite(top_up_6km_lapse)],
                                                    bottom_up_6km_lapse[np.isfinite(bottom_up_6km_lapse)]))
    up_mid_rh_t,up_mid_rh_pvalue_t=(stats.ttest_ind(top_up_mid_rh[np.isfinite(top_up_mid_rh)],
                                                    bottom_up_mid_rh[np.isfinite(bottom_up_mid_rh)]))
    up_sfc_theta_t,up_sfc_theta_pvalue_t=(stats.ttest_ind(top_up_sfc_theta[np.isfinite(top_up_sfc_theta)],
                                                    bottom_up_sfc_theta[np.isfinite(bottom_up_sfc_theta)]))
    up_ml_theta_t,up_ml_theta_pvalue_t=(stats.ttest_ind(top_up_ml_theta[np.isfinite(top_up_ml_theta)],
                                                    bottom_up_ml_theta[np.isfinite(bottom_up_ml_theta)]))
    up_dcape_t,up_dcape_pvalue_t=(stats.ttest_ind(top_up_dcape[np.isfinite(top_up_dcape)],
                                                   bottom_up_dcape[np.isfinite(bottom_up_dcape)]))
                                                                                                                                                            

    #Peak
    peak_lcl_t,peak_lcl_pvalue_t=(stats.ttest_ind(top_peak_lcl[np.isfinite(top_peak_lcl)], 
                                            bottom_peak_lcl[np.isfinite(bottom_peak_lcl)]))
    peak_lfc_t,peak_lfc_pvalue_t=(stats.ttest_ind(top_peak_lfc[np.isfinite(top_peak_lfc)], 
                                            bottom_peak_lfc[np.isfinite(bottom_peak_lfc)]))
    peak_el_t,peak_el_pvalue_t=(stats.ttest_ind(top_peak_el[np.isfinite(top_peak_el)], 
                                          bottom_peak_el[np.isfinite(bottom_peak_el)]))
    peak_h0_t,peak_h0_pvalue_t=(stats.ttest_ind(top_peak_h0[np.isfinite(top_peak_h0)],
                                          bottom_peak_h0[np.isfinite(bottom_peak_h0)]))
    peak_h_neg20_t,peak_h_neg20_pvalue_t=(stats.ttest_ind(top_peak_h_neg20[np.isfinite(top_peak_h_neg20)], 
                                                    bottom_peak_h_neg20[np.isfinite(bottom_peak_h_neg20)]))
    peak_wbzh_t,peak_wbzh_pvalue_t=(stats.ttest_ind(top_peak_wbzh[np.isfinite(top_peak_wbzh)], 
                                              bottom_peak_wbzh[np.isfinite(bottom_peak_wbzh)]))
    peak_1km_srh_t,peak_1km_srh_pvalue_t=(stats.ttest_ind(top_peak_1km_srh[np.isfinite(top_peak_1km_srh)],
                                                    bottom_peak_1km_srh[np.isfinite(bottom_peak_1km_srh)]))
    peak_3km_srh_t,peak_3km_srh_pvalue_t=(stats.ttest_ind(top_peak_3km_srh[np.isfinite(top_peak_3km_srh)],
                                                    bottom_peak_3km_srh[np.isfinite(bottom_peak_3km_srh)]))
    peak_1km_shear_t,peak_1km_shear_pvalue_t=(stats.ttest_ind(top_peak_1km_shear[np.isfinite(top_peak_1km_shear)],
                                                    bottom_peak_1km_shear[np.isfinite(bottom_peak_1km_shear)]))
    peak_3km_shear_t,peak_3km_shear_pvalue_t=(stats.ttest_ind(top_peak_3km_shear[np.isfinite(top_peak_3km_shear)],
                                                    bottom_peak_3km_shear[np.isfinite(bottom_peak_3km_shear)]))
    peak_6km_shear_t,peak_6km_shear_pvalue_t=(stats.ttest_ind(top_peak_6km_shear[np.isfinite(top_peak_6km_shear)],
                                                    bottom_peak_6km_shear[np.isfinite(bottom_peak_6km_shear)]))
    peak_sbcape_t,peak_sbcape_pvalue_t=(stats.ttest_ind(top_peak_sbcape[np.isfinite(top_peak_sbcape)],
                                                    bottom_peak_sbcape[np.isfinite(bottom_peak_sbcape)]))
    peak_mlcape_t,peak_mlcape_pvalue_t=(stats.ttest_ind(top_peak_mlcape[np.isfinite(top_peak_mlcape)],
                                                    bottom_peak_mlcape[np.isfinite(bottom_peak_mlcape)]))
    peak_mucape_t,peak_mucape_pvalue_t=(stats.ttest_ind(top_peak_mucape[np.isfinite(top_peak_mucape)],
                                                    bottom_peak_mucape[np.isfinite(bottom_peak_mucape)]))
    peak_sbcin_t,peak_sbcin_pvalue_t=(stats.ttest_ind(top_peak_sbcin[np.isfinite(top_peak_sbcin)],
                                                    bottom_peak_sbcin[np.isfinite(bottom_peak_sbcin)]))
    peak_mlcin_t,peak_mlcin_pvalue_t=(stats.ttest_ind(top_peak_mlcin[np.isfinite(top_peak_mlcin)],
                                                    bottom_peak_mlcin[np.isfinite(bottom_peak_mlcin)]))
    peak_mucin_t,peak_mucin_pvalue_t=(stats.ttest_ind(top_peak_mucin[np.isfinite(top_peak_mucin)],
                                                    bottom_peak_mucin[np.isfinite(bottom_peak_mucin)]))
    peak_stp_t,peak_stp_pvalue_t=(stats.ttest_ind(top_peak_stp[np.isfinite(top_peak_stp)],
                                                    bottom_peak_stp[np.isfinite(bottom_peak_stp)]))
    peak_scp_t,peak_scp_pvalue_t=(stats.ttest_ind(top_peak_scp[np.isfinite(top_peak_scp)],
                                                    bottom_peak_scp[np.isfinite(bottom_peak_scp)]))
    peak_sherb_t,peak_sherb_pvalue_t=(stats.ttest_ind(top_peak_sherb[np.isfinite(top_peak_sherb)],
                                                    bottom_peak_sherb[np.isfinite(bottom_peak_sherb)]))
    peak_1km_lapse_t,peak_1km_lapse_pvalue_t=(stats.ttest_ind(top_peak_1km_lapse[np.isfinite(top_peak_1km_lapse)],
                                                    bottom_peak_1km_lapse[np.isfinite(bottom_peak_1km_lapse)]))
    peak_2km_lapse_t,peak_2km_lapse_pvalue_t=(stats.ttest_ind(top_peak_2km_lapse[np.isfinite(top_peak_2km_lapse)],
                                                    bottom_peak_2km_lapse[np.isfinite(bottom_peak_2km_lapse)]))
    peak_3km_lapse_t,peak_3km_lapse_pvalue_t=(stats.ttest_ind(top_peak_3km_lapse[np.isfinite(top_peak_3km_lapse)],
                                                    bottom_peak_3km_lapse[np.isfinite(bottom_peak_3km_lapse)]))
    peak_6km_lapse_t,peak_6km_lapse_pvalue_t=(stats.ttest_ind(top_peak_6km_lapse[np.isfinite(top_peak_6km_lapse)],
                                                    bottom_peak_6km_lapse[np.isfinite(bottom_peak_6km_lapse)]))
    peak_mid_rh_t,peak_mid_rh_pvalue_t=(stats.ttest_ind(top_peak_mid_rh[np.isfinite(top_peak_mid_rh)],
                                                    bottom_peak_mid_rh[np.isfinite(bottom_peak_mid_rh)]))
    peak_sfc_theta_t,peak_sfc_theta_pvalue_t=(stats.ttest_ind(top_peak_sfc_theta[np.isfinite(top_peak_sfc_theta)],
                                                    bottom_peak_sfc_theta[np.isfinite(bottom_peak_sfc_theta)]))
    peak_ml_theta_t,peak_ml_theta_pvalue_t=(stats.ttest_ind(top_peak_ml_theta[np.isfinite(top_peak_ml_theta)],
                                                    bottom_peak_ml_theta[np.isfinite(bottom_peak_ml_theta)]))
    peak_dcape_t,peak_dcape_pvalue_t=(stats.ttest_ind(top_peak_dcape[np.isfinite(top_peak_dcape)],
                                                   bottom_peak_dcape[np.isfinite(bottom_peak_dcape)]))

    #Downstream
    down_lcl_t,down_lcl_pvalue_t=(stats.ttest_ind(top_down_lcl[np.isfinite(top_down_lcl)], 
                                            bottom_down_lcl[np.isfinite(bottom_down_lcl)]))
    down_lfc_t,down_lfc_pvalue_t=(stats.ttest_ind(top_down_lfc[np.isfinite(top_down_lfc)], 
                                            bottom_down_lfc[np.isfinite(bottom_down_lfc)]))
    down_el_t,down_el_pvalue_t=(stats.ttest_ind(top_down_el[np.isfinite(top_down_el)], 
                                          bottom_down_el[np.isfinite(bottom_down_el)]))
    down_h0_t,down_h0_pvalue_t=(stats.ttest_ind(top_down_h0[np.isfinite(top_down_h0)],
                                          bottom_down_h0[np.isfinite(bottom_down_h0)]))
    down_h_neg20_t,down_h_neg20_pvalue_t=(stats.ttest_ind(top_down_h_neg20[np.isfinite(top_down_h_neg20)], 
                                                    bottom_down_h_neg20[np.isfinite(bottom_down_h_neg20)]))
    down_wbzh_t,down_wbzh_pvalue_t=(stats.ttest_ind(top_down_wbzh[np.isfinite(top_down_wbzh)], 
                                              bottom_down_wbzh[np.isfinite(bottom_down_wbzh)]))
    down_1km_srh_t,down_1km_srh_pvalue_t=(stats.ttest_ind(top_down_1km_srh[np.isfinite(top_down_1km_srh)],
                                                    bottom_down_1km_srh[np.isfinite(bottom_down_1km_srh)]))
    down_3km_srh_t,down_3km_srh_pvalue_t=(stats.ttest_ind(top_down_3km_srh[np.isfinite(top_down_3km_srh)],
                                                    bottom_down_3km_srh[np.isfinite(bottom_down_3km_srh)]))
    down_1km_shear_t,down_1km_shear_pvalue_t=(stats.ttest_ind(top_down_1km_shear[np.isfinite(top_down_1km_shear)],
                                                    bottom_down_1km_shear[np.isfinite(bottom_down_1km_shear)]))
    down_3km_shear_t,down_3km_shear_pvalue_t=(stats.ttest_ind(top_down_3km_shear[np.isfinite(top_down_3km_shear)],
                                                    bottom_down_3km_shear[np.isfinite(bottom_down_3km_shear)]))
    down_6km_shear_t,down_6km_shear_pvalue_t=(stats.ttest_ind(top_down_6km_shear[np.isfinite(top_down_6km_shear)],
                                                    bottom_down_6km_shear[np.isfinite(bottom_down_6km_shear)]))
    down_sbcape_t,down_sbcape_pvalue_t=(stats.ttest_ind(top_down_sbcape[np.isfinite(top_down_sbcape)],
                                                    bottom_down_sbcape[np.isfinite(bottom_down_sbcape)]))
    down_mlcape_t,down_mlcape_pvalue_t=(stats.ttest_ind(top_down_mlcape[np.isfinite(top_down_mlcape)],
                                                    bottom_down_mlcape[np.isfinite(bottom_down_mlcape)]))
    down_mucape_t,down_mucape_pvalue_t=(stats.ttest_ind(top_down_mucape[np.isfinite(top_down_mucape)],
                                                    bottom_down_mucape[np.isfinite(bottom_down_mucape)]))
    down_sbcin_t,down_sbcin_pvalue_t=(stats.ttest_ind(top_down_sbcin[np.isfinite(top_down_sbcin)],
                                                    bottom_down_sbcin[np.isfinite(bottom_down_sbcin)]))
    down_mlcin_t,down_mlcin_pvalue_t=(stats.ttest_ind(top_down_mlcin[np.isfinite(top_down_mlcin)],
                                                    bottom_down_mlcin[np.isfinite(bottom_down_mlcin)]))
    down_mucin_t,down_mucin_pvalue_t=(stats.ttest_ind(top_down_mucin[np.isfinite(top_down_mucin)],
                                                    bottom_down_mucin[np.isfinite(bottom_down_mucin)]))
    down_stp_t,down_stp_pvalue_t=(stats.ttest_ind(top_down_stp[np.isfinite(top_down_stp)],
                                                    bottom_down_stp[np.isfinite(bottom_down_stp)]))
    down_scp_t,down_scp_pvalue_t=(stats.ttest_ind(top_down_scp[np.isfinite(top_down_scp)],
                                                    bottom_down_scp[np.isfinite(bottom_down_scp)]))
    down_sherb_t,down_sherb_pvalue_t=(stats.ttest_ind(top_down_sherb[np.isfinite(top_down_sherb)],
                                                    bottom_down_sherb[np.isfinite(bottom_down_sherb)]))
    down_1km_lapse_t,down_1km_lapse_pvalue_t=(stats.ttest_ind(top_down_1km_lapse[np.isfinite(top_down_1km_lapse)],
                                                    bottom_down_1km_lapse[np.isfinite(bottom_down_1km_lapse)]))
    down_2km_lapse_t,down_2km_lapse_pvalue_t=(stats.ttest_ind(top_down_2km_lapse[np.isfinite(top_down_2km_lapse)],
                                                    bottom_down_2km_lapse[np.isfinite(bottom_down_2km_lapse)]))
    down_3km_lapse_t,down_3km_lapse_pvalue_t=(stats.ttest_ind(top_down_3km_lapse[np.isfinite(top_down_3km_lapse)],
                                                    bottom_down_3km_lapse[np.isfinite(bottom_down_3km_lapse)]))
    down_6km_lapse_t,down_6km_lapse_pvalue_t=(stats.ttest_ind(top_down_6km_lapse[np.isfinite(top_down_6km_lapse)],
                                                    bottom_down_6km_lapse[np.isfinite(bottom_down_6km_lapse)]))
    down_mid_rh_t,down_mid_rh_pvalue_t=(stats.ttest_ind(top_down_mid_rh[np.isfinite(top_down_mid_rh)],
                                                    bottom_down_mid_rh[np.isfinite(bottom_down_mid_rh)]))
    down_sfc_theta_t,down_sfc_theta_pvalue_t=(stats.ttest_ind(top_down_sfc_theta[np.isfinite(top_down_sfc_theta)],
                                                    bottom_down_sfc_theta[np.isfinite(bottom_down_sfc_theta)]))
    down_ml_theta_t,down_ml_theta_pvalue_t=(stats.ttest_ind(top_down_ml_theta[np.isfinite(top_down_ml_theta)],
                                                    bottom_down_ml_theta[np.isfinite(bottom_down_ml_theta)]))
    down_dcape_t,down_dcape_pvalue_t=(stats.ttest_ind(top_down_dcape[np.isfinite(top_down_dcape)],
                                                   bottom_down_dcape[np.isfinite(bottom_down_dcape)]))


    top=input('Top variable: ')
    bottom=input('Bottom variable: ')
    
    
    outfile.write('Upstream'+'\t'+'\t'+'\t'+'\t'+'\t'+'\t'+'\t'+'\t'+'Peak'+'\t'+'\t'+'\t'+'\t'+'\t'+'\t'+'\t'+'\t'+
                 'Downstream'+'\t'+'\t'+'\t'+'\t'+'\t'+'\t'+'\t'+'\t'+'\n')
    outfile.write('Parameter'+'\t'+str(top)+' mean'+'\t'+str(bottom)+' mean'+'\t'+'KS Stat'+'\t'+'KS P-value'+'\t'+
                 'T Stat'+'\t'+'T P-value'+'\t'+'\t'+'Parameter'+'\t'+str(top)+' mean'+'\t'+str(bottom)+' mean'+'\t'+
                  'KS Stat'+'\t'+'KS P-value'+'\t'+'T Stat'+'\t'+'T P-value'+'\t'+'\t'+'Parameter'+'\t'+str(top)+' mean'+
                  '\t'+str(bottom)+' mean'+'\t'+'KS Stat'+'\t'+'KS P-value'+'\t'+'T Stat'+'\t'+'T P-value'+'\n')
    outfile.write('LCL:'+'\t'+str(top_up_lcl_mean)+'\t'+str(bottom_up_lcl_mean)+'\t'+str(up_lcl_ks)+'\t'+
                 str(up_lcl_pvalue)+'\t'+str(up_lcl_t)+'\t'+str(up_lcl_pvalue_t)+'\t'+'\t'+'LCL:'+'\t'+
                  str(top_peak_lcl_mean)+'\t'+str(bottom_peak_lcl_mean)+'\t'+str(peak_lcl_ks)+'\t'+
                 str(peak_lcl_pvalue)+'\t'+str(peak_lcl_t)+'\t'+str(peak_lcl_pvalue_t)+'\t'+'\t'+'LCL:'+'\t'+
                  str(top_down_lcl_mean)+'\t'+str(bottom_down_lcl_mean)+'\t'+str(down_lcl_ks)+'\t'+
                 str(down_lcl_pvalue)+'\t'+str(down_lcl_t)+'\t'+str(down_lcl_pvalue_t)+'\n')
    outfile.write('LFC:'+'\t'+str(top_up_lfc_mean)+'\t'+str(bottom_up_lfc_mean)+'\t'+str(up_lfc_ks)+'\t'+
                 str(up_lfc_pvalue)+'\t'+str(up_lfc_t)+'\t'+str(up_lfc_pvalue_t)+'\t'+'\t'+'LFC:'+'\t'+
                  str(top_peak_lfc_mean)+'\t'+str(bottom_peak_lfc_mean)+'\t'+str(peak_lfc_ks)+'\t'+
                 str(peak_lfc_pvalue)+'\t'+str(peak_lfc_t)+'\t'+str(peak_lfc_pvalue_t)+'\t'+'\t'+'LFC:'+'\t'+
                  str(top_down_lfc_mean)+'\t'+str(bottom_down_lfc_mean)+'\t'+str(down_lfc_ks)+'\t'+
                 str(down_lfc_pvalue)+'\t'+str(down_lfc_t)+'\t'+str(down_lfc_pvalue_t)+'\n')
    outfile.write('EL:'+'\t'+str(top_up_el_mean)+'\t'+str(bottom_up_el_mean)+'\t'+str(up_el_ks)+'\t'+
                 str(up_el_pvalue)+'\t'+str(up_el_t)+'\t'+str(up_el_pvalue_t)+'\t'+'\t'+'EL:'+'\t'+
                  str(top_peak_el_mean)+'\t'+str(bottom_peak_el_mean)+'\t'+str(peak_el_ks)+'\t'+
                 str(peak_el_pvalue)+'\t'+str(peak_el_t)+'\t'+str(peak_el_pvalue_t)+'\t'+'\t'+'EL:'+'\t'+
                  str(top_down_el_mean)+'\t'+str(bottom_down_el_mean)+'\t'+str(down_el_ks)+'\t'+
                 str(down_el_pvalue)+'\t'+str(down_el_t)+'\t'+str(down_el_pvalue_t)+'\n')
    outfile.write('H0:'+'\t'+str(top_up_h0_mean)+'\t'+str(bottom_up_h0_mean)+'\t'+str(up_h0_ks)+'\t'+
                 str(up_h0_pvalue)+'\t'+str(up_h0_t)+'\t'+str(up_h0_pvalue_t)+'\t'+'\t'+'H0:'+'\t'+
                  str(top_peak_h0_mean)+'\t'+str(bottom_peak_h0_mean)+'\t'+str(peak_h0_ks)+'\t'+
                 str(peak_h0_pvalue)+'\t'+str(peak_h0_t)+'\t'+str(peak_h0_pvalue_t)+'\t'+'\t'+'H0:'+'\t'+
                  str(top_down_h0_mean)+'\t'+str(bottom_down_h0_mean)+'\t'+str(down_h0_ks)+'\t'+
                 str(down_h0_pvalue)+'\t'+str(down_h0_t)+'\t'+str(down_h0_pvalue_t)+'\n')
    outfile.write('H_NEG20:'+'\t'+str(top_up_h_neg20_mean)+'\t'+str(bottom_up_h_neg20_mean)+'\t'+str(up_h_neg20_ks)+'\t'+
                 str(up_h_neg20_pvalue)+'\t'+str(up_h_neg20_t)+'\t'+str(up_h_neg20_pvalue_t)+'\t'+'\t'+'H_NEG20:'+'\t'+
                  str(top_peak_h_neg20_mean)+'\t'+str(bottom_peak_h_neg20_mean)+'\t'+str(peak_h_neg20_ks)+'\t'+
                 str(peak_h_neg20_pvalue)+'\t'+str(peak_h_neg20_t)+'\t'+str(peak_h_neg20_pvalue_t)+'\t'+'\t'+'H_NEG20:'+'\t'+
                  str(top_down_h_neg20_mean)+'\t'+str(bottom_down_h_neg20_mean)+'\t'+str(down_h_neg20_ks)+'\t'+
                 str(down_h_neg20_pvalue)+'\t'+str(down_h_neg20_t)+'\t'+str(down_h_neg20_pvalue_t)+'\n')
    outfile.write('WBZH:'+'\t'+str(top_up_wbzh_mean)+'\t'+str(bottom_up_wbzh_mean)+'\t'+str(up_wbzh_ks)+'\t'+
                 str(up_wbzh_pvalue)+'\t'+str(up_wbzh_t)+'\t'+str(up_wbzh_pvalue_t)+'\t'+'\t'+'WBZH:'+'\t'+
                  str(top_peak_wbzh_mean)+'\t'+str(bottom_peak_wbzh_mean)+'\t'+str(peak_wbzh_ks)+'\t'+
                 str(peak_wbzh_pvalue)+'\t'+str(peak_wbzh_t)+'\t'+str(peak_wbzh_pvalue_t)+'\t'+'\t'+'WBZH:'+'\t'+
                  str(top_down_wbzh_mean)+'\t'+str(bottom_down_wbzh_mean)+'\t'+str(down_wbzh_ks)+'\t'+
                 str(down_wbzh_pvalue)+'\t'+str(down_wbzh_t)+'\t'+str(down_wbzh_pvalue_t)+'\n')
    outfile.write('1KM_SRH:'+'\t'+str(top_up_1km_srh_mean)+'\t'+str(bottom_up_1km_srh_mean)+'\t'+str(up_1km_srh_ks)+'\t'+
                 str(up_1km_srh_pvalue)+'\t'+str(up_1km_srh_t)+'\t'+str(up_1km_srh_pvalue_t)+'\t'+'\t'+'1KM_SRH:'+'\t'+
                  str(top_peak_1km_srh_mean)+'\t'+str(bottom_peak_1km_srh_mean)+'\t'+str(peak_1km_srh_ks)+'\t'+
                 str(peak_1km_srh_pvalue)+'\t'+str(peak_1km_srh_t)+'\t'+str(peak_1km_srh_pvalue_t)+'\t'+'\t'+'1KM_SRH:'+'\t'+
                  str(top_down_1km_srh_mean)+'\t'+str(bottom_down_1km_srh_mean)+'\t'+str(down_1km_srh_ks)+'\t'+
                 str(down_1km_srh_pvalue)+'\t'+str(down_1km_srh_t)+'\t'+str(down_1km_srh_pvalue_t)+'\n')
    outfile.write('3KM_SRH:'+'\t'+str(top_up_3km_srh_mean)+'\t'+str(bottom_up_3km_srh_mean)+'\t'+str(up_3km_srh_ks)+'\t'+
                 str(up_3km_srh_pvalue)+'\t'+str(up_3km_srh_t)+'\t'+str(up_3km_srh_pvalue_t)+'\t'+'\t'+'3KM_SRH:'+'\t'+
                  str(top_peak_3km_srh_mean)+'\t'+str(bottom_peak_3km_srh_mean)+'\t'+str(peak_3km_srh_ks)+'\t'+
                 str(peak_3km_srh_pvalue)+'\t'+str(peak_3km_srh_t)+'\t'+str(peak_3km_srh_pvalue_t)+'\t'+'\t'+'3KM_SRH:'+'\t'+
                  str(top_down_3km_srh_mean)+'\t'+str(bottom_down_3km_srh_mean)+'\t'+str(down_3km_srh_ks)+'\t'+
                 str(down_3km_srh_pvalue)+'\t'+str(down_3km_srh_t)+'\t'+str(down_3km_srh_pvalue_t)+'\n')
    outfile.write('1KM_SHEAR:'+'\t'+str(top_up_1km_shear_mean)+'\t'+str(bottom_up_1km_shear_mean)+'\t'+str(up_1km_shear_ks)+'\t'+
                 str(up_1km_shear_pvalue)+'\t'+str(up_1km_shear_t)+'\t'+str(up_1km_shear_pvalue_t)+'\t'+'\t'+'1KM_SHEAR:'+'\t'+
                  str(top_peak_1km_shear_mean)+'\t'+str(bottom_peak_1km_shear_mean)+'\t'+str(peak_1km_shear_ks)+'\t'+
                 str(peak_1km_shear_pvalue)+'\t'+str(peak_1km_shear_t)+'\t'+str(peak_1km_shear_pvalue_t)+'\t'+'\t'+'1KM_SHEAR:'+'\t'+
                  str(top_down_1km_shear_mean)+'\t'+str(bottom_down_1km_shear_mean)+'\t'+str(down_1km_shear_ks)+'\t'+
                 str(down_1km_shear_pvalue)+'\t'+str(down_1km_shear_t)+'\t'+str(down_1km_shear_pvalue_t)+'\n')
    outfile.write('3KM_SHEAR:'+'\t'+str(top_up_3km_shear_mean)+'\t'+str(bottom_up_3km_shear_mean)+'\t'+str(up_3km_shear_ks)+'\t'+
                 str(up_3km_shear_pvalue)+'\t'+str(up_3km_shear_t)+'\t'+str(up_3km_shear_pvalue_t)+'\t'+'\t'+'3KM_SHEAR:'+'\t'+
                  str(top_peak_3km_shear_mean)+'\t'+str(bottom_peak_3km_shear_mean)+'\t'+str(peak_3km_shear_ks)+'\t'+
                 str(peak_3km_shear_pvalue)+'\t'+str(peak_3km_shear_t)+'\t'+str(peak_3km_shear_pvalue_t)+'\t'+'\t'+'3KM_SHEAR:'+'\t'+
                  str(top_down_3km_shear_mean)+'\t'+str(bottom_down_3km_shear_mean)+'\t'+str(down_3km_shear_ks)+'\t'+
                 str(down_3km_shear_pvalue)+'\t'+str(down_3km_shear_t)+'\t'+str(down_3km_shear_pvalue_t)+'\n')
    outfile.write('6KM_SHEAR:'+'\t'+str(top_up_6km_shear_mean)+'\t'+str(bottom_up_6km_shear_mean)+'\t'+str(up_6km_shear_ks)+'\t'+
                 str(up_6km_shear_pvalue)+'\t'+str(up_6km_shear_t)+'\t'+str(up_6km_shear_pvalue_t)+'\t'+'\t'+'6KM_SHEAR:'+'\t'+
                  str(top_peak_6km_shear_mean)+'\t'+str(bottom_peak_6km_shear_mean)+'\t'+str(peak_6km_shear_ks)+'\t'+
                 str(peak_6km_shear_pvalue)+'\t'+str(peak_6km_shear_t)+'\t'+str(peak_6km_shear_pvalue_t)+'\t'+'\t'+'6KM_SHEAR:'+'\t'+
                  str(top_down_6km_shear_mean)+'\t'+str(bottom_down_6km_shear_mean)+'\t'+str(down_6km_shear_ks)+'\t'+
                 str(down_6km_shear_pvalue)+'\t'+str(down_6km_shear_t)+'\t'+str(down_6km_shear_pvalue_t)+'\n')
    outfile.write('sbcape:'+'\t'+str(top_up_sbcape_mean)+'\t'+str(bottom_up_sbcape_mean)+'\t'+str(up_sbcape_ks)+'\t'+
                 str(up_sbcape_pvalue)+'\t'+str(up_sbcape_t)+'\t'+str(up_sbcape_pvalue_t)+'\t'+'\t'+'sbcape:'+'\t'+
                  str(top_peak_sbcape_mean)+'\t'+str(bottom_peak_sbcape_mean)+'\t'+str(peak_sbcape_ks)+'\t'+
                 str(peak_sbcape_pvalue)+'\t'+str(peak_sbcape_t)+'\t'+str(peak_sbcape_pvalue_t)+'\t'+'\t'+'sbcape:'+'\t'+
                  str(top_down_sbcape_mean)+'\t'+str(bottom_down_sbcape_mean)+'\t'+str(down_sbcape_ks)+'\t'+
                 str(down_sbcape_pvalue)+'\t'+str(down_sbcape_t)+'\t'+str(down_sbcape_pvalue_t)+'\n')
    outfile.write('mlcape:'+'\t'+str(top_up_mlcape_mean)+'\t'+str(bottom_up_mlcape_mean)+'\t'+str(up_mlcape_ks)+'\t'+
                 str(up_mlcape_pvalue)+'\t'+str(up_mlcape_t)+'\t'+str(up_mlcape_pvalue_t)+'\t'+'\t'+'mlcape:'+'\t'+
                  str(top_peak_mlcape_mean)+'\t'+str(bottom_peak_mlcape_mean)+'\t'+str(peak_mlcape_ks)+'\t'+
                 str(peak_mlcape_pvalue)+'\t'+str(peak_mlcape_t)+'\t'+str(peak_mlcape_pvalue_t)+'\t'+'\t'+'mlcape:'+'\t'+
                  str(top_down_mlcape_mean)+'\t'+str(bottom_down_mlcape_mean)+'\t'+str(down_mlcape_ks)+'\t'+
                 str(down_mlcape_pvalue)+'\t'+str(down_mlcape_t)+'\t'+str(down_mlcape_pvalue_t)+'\n')
    outfile.write('mucape:'+'\t'+str(top_up_mucape_mean)+'\t'+str(bottom_up_mucape_mean)+'\t'+str(up_mucape_ks)+'\t'+
                 str(up_mucape_pvalue)+'\t'+str(up_mucape_t)+'\t'+str(up_mucape_pvalue_t)+'\t'+'\t'+'mucape:'+'\t'+
                  str(top_peak_mucape_mean)+'\t'+str(bottom_peak_mucape_mean)+'\t'+str(peak_mucape_ks)+'\t'+
                 str(peak_mucape_pvalue)+'\t'+str(peak_mucape_t)+'\t'+str(peak_mucape_pvalue_t)+'\t'+'\t'+'mucape:'+'\t'+
                  str(top_down_mucape_mean)+'\t'+str(bottom_down_mucape_mean)+'\t'+str(down_mucape_ks)+'\t'+
                 str(down_mucape_pvalue)+'\t'+str(down_mucape_t)+'\t'+str(down_mucape_pvalue_t)+'\n')
    outfile.write('sbcin:'+'\t'+str(top_up_sbcin_mean)+'\t'+str(bottom_up_sbcin_mean)+'\t'+str(up_sbcin_ks)+'\t'+
                 str(up_sbcin_pvalue)+'\t'+str(up_sbcin_t)+'\t'+str(up_sbcin_pvalue_t)+'\t'+'\t'+'sbcin:'+'\t'+
                  str(top_peak_sbcin_mean)+'\t'+str(bottom_peak_sbcin_mean)+'\t'+str(peak_sbcin_ks)+'\t'+
                 str(peak_sbcin_pvalue)+'\t'+str(peak_sbcin_t)+'\t'+str(peak_sbcin_pvalue_t)+'\t'+'\t'+'sbcin:'+'\t'+
                  str(top_down_sbcin_mean)+'\t'+str(bottom_down_sbcin_mean)+'\t'+str(down_sbcin_ks)+'\t'+
                 str(down_sbcin_pvalue)+'\t'+str(down_sbcin_t)+'\t'+str(down_sbcin_pvalue_t)+'\n')
    outfile.write('mlcin:'+'\t'+str(top_up_mlcin_mean)+'\t'+str(bottom_up_mlcin_mean)+'\t'+str(up_mlcin_ks)+'\t'+
                 str(up_mlcin_pvalue)+'\t'+str(up_mlcin_t)+'\t'+str(up_mlcin_pvalue_t)+'\t'+'\t'+'mlcin:'+'\t'+
                  str(top_peak_mlcin_mean)+'\t'+str(bottom_peak_mlcin_mean)+'\t'+str(peak_mlcin_ks)+'\t'+
                 str(peak_mlcin_pvalue)+'\t'+str(peak_mlcin_t)+'\t'+str(peak_mlcin_pvalue_t)+'\t'+'\t'+'mlcin:'+'\t'+
                  str(top_down_mlcin_mean)+'\t'+str(bottom_down_mlcin_mean)+'\t'+str(down_mlcin_ks)+'\t'+
                 str(down_mlcin_pvalue)+'\t'+str(down_mlcin_t)+'\t'+str(down_mlcin_pvalue_t)+'\n')
    outfile.write('mucin:'+'\t'+str(top_up_mucin_mean)+'\t'+str(bottom_up_mucin_mean)+'\t'+str(up_mucin_ks)+'\t'+
                 str(up_mucin_pvalue)+'\t'+str(up_mucin_t)+'\t'+str(up_mucin_pvalue_t)+'\t'+'\t'+'mucin:'+'\t'+
                  str(top_peak_mucin_mean)+'\t'+str(bottom_peak_mucin_mean)+'\t'+str(peak_mucin_ks)+'\t'+
                 str(peak_mucin_pvalue)+'\t'+str(peak_mucin_t)+'\t'+str(peak_mucin_pvalue_t)+'\t'+'\t'+'mucin:'+'\t'+
                  str(top_down_mucin_mean)+'\t'+str(bottom_down_mucin_mean)+'\t'+str(down_mucin_ks)+'\t'+
                 str(down_mucin_pvalue)+'\t'+str(down_mucin_t)+'\t'+str(down_mucin_pvalue_t)+'\n')
    outfile.write('stp:'+'\t'+str(top_up_stp_mean)+'\t'+str(bottom_up_stp_mean)+'\t'+str(up_stp_ks)+'\t'+
                 str(up_stp_pvalue)+'\t'+str(up_stp_t)+'\t'+str(up_stp_pvalue_t)+'\t'+'\t'+'stp:'+'\t'+
                  str(top_peak_stp_mean)+'\t'+str(bottom_peak_stp_mean)+'\t'+str(peak_stp_ks)+'\t'+
                 str(peak_stp_pvalue)+'\t'+str(peak_stp_t)+'\t'+str(peak_stp_pvalue_t)+'\t'+'\t'+'stp:'+'\t'+
                  str(top_down_stp_mean)+'\t'+str(bottom_down_stp_mean)+'\t'+str(down_stp_ks)+'\t'+
                 str(down_stp_pvalue)+'\t'+str(down_stp_t)+'\t'+str(down_stp_pvalue_t)+'\n')
    outfile.write('scp:'+'\t'+str(top_up_scp_mean)+'\t'+str(bottom_up_scp_mean)+'\t'+str(up_scp_ks)+'\t'+
                 str(up_scp_pvalue)+'\t'+str(up_scp_t)+'\t'+str(up_scp_pvalue_t)+'\t'+'\t'+'scp:'+'\t'+
                  str(top_peak_scp_mean)+'\t'+str(bottom_peak_scp_mean)+'\t'+str(peak_scp_ks)+'\t'+
                 str(peak_scp_pvalue)+'\t'+str(peak_scp_t)+'\t'+str(peak_scp_pvalue_t)+'\t'+'\t'+'scp:'+'\t'+
                  str(top_down_scp_mean)+'\t'+str(bottom_down_scp_mean)+'\t'+str(down_scp_ks)+'\t'+
                 str(down_scp_pvalue)+'\t'+str(down_scp_t)+'\t'+str(down_scp_pvalue_t)+'\n')
    outfile.write('scp:'+'\t'+str(top_up_scp_mean)+'\t'+str(bottom_up_scp_mean)+'\t'+str(up_scp_ks)+'\t'+
                 str(up_scp_pvalue)+'\t'+str(up_scp_t)+'\t'+str(up_scp_pvalue_t)+'\t'+'\t'+'scp:'+'\t'+
                  str(top_peak_scp_mean)+'\t'+str(bottom_peak_scp_mean)+'\t'+str(peak_scp_ks)+'\t'+
                 str(peak_scp_pvalue)+'\t'+str(peak_scp_t)+'\t'+str(peak_scp_pvalue_t)+'\t'+'\t'+'scp:'+'\t'+
                  str(top_down_scp_mean)+'\t'+str(bottom_down_scp_mean)+'\t'+str(down_scp_ks)+'\t'+
                 str(down_scp_pvalue)+'\t'+str(down_scp_t)+'\t'+str(down_scp_pvalue_t)+'\n')
    outfile.write('sherb:'+'\t'+str(top_up_sherb_mean)+'\t'+str(bottom_up_sherb_mean)+'\t'+str(up_sherb_ks)+'\t'+
                 str(up_sherb_pvalue)+'\t'+str(up_sherb_t)+'\t'+str(up_sherb_pvalue_t)+'\t'+'\t'+'sherb:'+'\t'+
                  str(top_peak_sherb_mean)+'\t'+str(bottom_peak_sherb_mean)+'\t'+str(peak_sherb_ks)+'\t'+
                 str(peak_sherb_pvalue)+'\t'+str(peak_sherb_t)+'\t'+str(peak_sherb_pvalue_t)+'\t'+'\t'+'sherb:'+'\t'+
                  str(top_down_sherb_mean)+'\t'+str(bottom_down_sherb_mean)+'\t'+str(down_sherb_ks)+'\t'+
                 str(down_sherb_pvalue)+'\t'+str(down_sherb_t)+'\t'+str(down_sherb_pvalue_t)+'\n')
    outfile.write('1km_lapse:'+'\t'+str(top_up_1km_lapse_mean)+'\t'+str(bottom_up_1km_lapse_mean)+'\t'+str(up_1km_lapse_ks)+'\t'+
                 str(up_1km_lapse_pvalue)+'\t'+str(up_1km_lapse_t)+'\t'+str(up_1km_lapse_pvalue_t)+'\t'+'\t'+'1km_lapse:'+'\t'+
                  str(top_peak_1km_lapse_mean)+'\t'+str(bottom_peak_1km_lapse_mean)+'\t'+str(peak_1km_lapse_ks)+'\t'+
                 str(peak_1km_lapse_pvalue)+'\t'+str(peak_1km_lapse_t)+'\t'+str(peak_1km_lapse_pvalue_t)+'\t'+'\t'+'1km_lapse:'+'\t'+
                  str(top_down_1km_lapse_mean)+'\t'+str(bottom_down_1km_lapse_mean)+'\t'+str(down_1km_lapse_ks)+'\t'+
                 str(down_1km_lapse_pvalue)+'\t'+str(down_1km_lapse_t)+'\t'+str(down_1km_lapse_pvalue_t)+'\n')
    outfile.write('2km_lapse:'+'\t'+str(top_up_2km_lapse_mean)+'\t'+str(bottom_up_2km_lapse_mean)+'\t'+str(up_2km_lapse_ks)+'\t'+
                 str(up_2km_lapse_pvalue)+'\t'+str(up_2km_lapse_t)+'\t'+str(up_2km_lapse_pvalue_t)+'\t'+'\t'+'2km_lapse:'+'\t'+
                  str(top_peak_2km_lapse_mean)+'\t'+str(bottom_peak_2km_lapse_mean)+'\t'+str(peak_2km_lapse_ks)+'\t'+
                 str(peak_2km_lapse_pvalue)+'\t'+str(peak_2km_lapse_t)+'\t'+str(peak_2km_lapse_pvalue_t)+'\t'+'\t'+'2km_lapse:'+'\t'+
                  str(top_down_2km_lapse_mean)+'\t'+str(bottom_down_2km_lapse_mean)+'\t'+str(down_2km_lapse_ks)+'\t'+
                 str(down_2km_lapse_pvalue)+'\t'+str(down_2km_lapse_t)+'\t'+str(down_2km_lapse_pvalue_t)+'\n')
    outfile.write('3km_lapse:'+'\t'+str(top_up_3km_lapse_mean)+'\t'+str(bottom_up_3km_lapse_mean)+'\t'+str(up_3km_lapse_ks)+'\t'+
                 str(up_3km_lapse_pvalue)+'\t'+str(up_3km_lapse_t)+'\t'+str(up_3km_lapse_pvalue_t)+'\t'+'\t'+'3km_lapse:'+'\t'+
                  str(top_peak_3km_lapse_mean)+'\t'+str(bottom_peak_3km_lapse_mean)+'\t'+str(peak_3km_lapse_ks)+'\t'+
                 str(peak_3km_lapse_pvalue)+'\t'+str(peak_3km_lapse_t)+'\t'+str(peak_3km_lapse_pvalue_t)+'\t'+'\t'+'3km_lapse:'+'\t'+
                  str(top_down_3km_lapse_mean)+'\t'+str(bottom_down_3km_lapse_mean)+'\t'+str(down_3km_lapse_ks)+'\t'+
                 str(down_3km_lapse_pvalue)+'\t'+str(down_3km_lapse_t)+'\t'+str(down_3km_lapse_pvalue_t)+'\n')
    outfile.write('6km_lapse:'+'\t'+str(top_up_6km_lapse_mean)+'\t'+str(bottom_up_6km_lapse_mean)+'\t'+str(up_6km_lapse_ks)+'\t'+
                 str(up_6km_lapse_pvalue)+'\t'+str(up_6km_lapse_t)+'\t'+str(up_6km_lapse_pvalue_t)+'\t'+'\t'+'6km_lapse:'+'\t'+
                  str(top_peak_6km_lapse_mean)+'\t'+str(bottom_peak_6km_lapse_mean)+'\t'+str(peak_6km_lapse_ks)+'\t'+
                 str(peak_6km_lapse_pvalue)+'\t'+str(peak_6km_lapse_t)+'\t'+str(peak_6km_lapse_pvalue_t)+'\t'+'\t'+'6km_lapse:'+'\t'+
                  str(top_down_6km_lapse_mean)+'\t'+str(bottom_down_6km_lapse_mean)+'\t'+str(down_6km_lapse_ks)+'\t'+
                 str(down_6km_lapse_pvalue)+'\t'+str(down_6km_lapse_t)+'\t'+str(down_6km_lapse_pvalue_t)+'\n')
    outfile.write('mid_rh:'+'\t'+str(top_up_mid_rh_mean)+'\t'+str(bottom_up_mid_rh_mean)+'\t'+str(up_mid_rh_ks)+'\t'+
                 str(up_mid_rh_pvalue)+'\t'+str(up_mid_rh_t)+'\t'+str(up_mid_rh_pvalue_t)+'\t'+'\t'+'mid_rh:'+'\t'+
                  str(top_peak_mid_rh_mean)+'\t'+str(bottom_peak_mid_rh_mean)+'\t'+str(peak_mid_rh_ks)+'\t'+
                 str(peak_mid_rh_pvalue)+'\t'+str(peak_mid_rh_t)+'\t'+str(peak_mid_rh_pvalue_t)+'\t'+'\t'+'mid_rh:'+'\t'+
                  str(top_down_mid_rh_mean)+'\t'+str(bottom_down_mid_rh_mean)+'\t'+str(down_mid_rh_ks)+'\t'+
                 str(down_mid_rh_pvalue)+'\t'+str(down_mid_rh_t)+'\t'+str(down_mid_rh_pvalue_t)+'\n')
    outfile.write('sfc_theta:'+'\t'+str(top_up_sfc_theta_mean)+'\t'+str(bottom_up_sfc_theta_mean)+'\t'+str(up_sfc_theta_ks)+'\t'+
                 str(up_sfc_theta_pvalue)+'\t'+str(up_sfc_theta_t)+'\t'+str(up_sfc_theta_pvalue_t)+'\t'+'\t'+'sfc_theta:'+'\t'+
                  str(top_peak_sfc_theta_mean)+'\t'+str(bottom_peak_sfc_theta_mean)+'\t'+str(peak_sfc_theta_ks)+'\t'+
                 str(peak_sfc_theta_pvalue)+'\t'+str(peak_sfc_theta_t)+'\t'+str(peak_sfc_theta_pvalue_t)+'\t'+'\t'+'sfc_theta:'+'\t'+
                  str(top_down_sfc_theta_mean)+'\t'+str(bottom_down_sfc_theta_mean)+'\t'+str(down_sfc_theta_ks)+'\t'+
                 str(down_sfc_theta_pvalue)+'\t'+str(down_sfc_theta_t)+'\t'+str(down_sfc_theta_pvalue_t)+'\n')
    outfile.write('ml_theta:'+'\t'+str(top_up_ml_theta_mean)+'\t'+str(bottom_up_ml_theta_mean)+'\t'+str(up_ml_theta_ks)+'\t'+
                 str(up_ml_theta_pvalue)+'\t'+str(up_ml_theta_t)+'\t'+str(up_ml_theta_pvalue_t)+'\t'+'\t'+'ml_theta:'+'\t'+
                  str(top_peak_ml_theta_mean)+'\t'+str(bottom_peak_ml_theta_mean)+'\t'+str(peak_ml_theta_ks)+'\t'+
                 str(peak_ml_theta_pvalue)+'\t'+str(peak_ml_theta_t)+'\t'+str(peak_ml_theta_pvalue_t)+'\t'+'\t'+'ml_theta:'+'\t'+
                  str(top_down_ml_theta_mean)+'\t'+str(bottom_down_ml_theta_mean)+'\t'+str(down_ml_theta_ks)+'\t'+
                 str(down_ml_theta_pvalue)+'\t'+str(down_ml_theta_t)+'\t'+str(down_ml_theta_pvalue_t)+'\n')
    outfile.write('dcape:'+'\t'+str(top_up_dcape_mean)+'\t'+str(bottom_up_dcape_mean)+'\t'+str(up_dcape_ks)+'\t'+
                 str(up_dcape_pvalue)+'\t'+str(up_dcape_t)+'\t'+str(up_dcape_pvalue_t)+'\t'+'\t'+'dcape:'+'\t'+
                  str(top_peak_dcape_mean)+'\t'+str(bottom_peak_dcape_mean)+'\t'+str(peak_dcape_ks)+'\t'+
                 str(peak_dcape_pvalue)+'\t'+str(peak_dcape_t)+'\t'+str(peak_dcape_pvalue_t)+'\t'+'\t'+'dcape:'+'\t'+
                  str(top_down_dcape_mean)+'\t'+str(bottom_down_dcape_mean)+'\t'+str(down_dcape_ks)+'\t'+
                 str(down_dcape_pvalue)+'\t'+str(down_dcape_t)+'\t'+str(down_dcape_pvalue_t)+'\n')
                 
#reads in files to calulate
up=pd.read_csv(r'/Users/filename.csv')
peak=pd.read_csv(r'/Users/filename.csv')
down=pd.read_csv(r'/Users/filename.csv')
out=open(r'/Users/filename.csv','w')

#calls definition
compare(up,peak,down,out)
